/*!
* ag-psd - JavaScript library for reading and writing PSD files (Photoshop Document files)
* @author   Agamnentzar
* @license  MIT
*/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).agPsd=e()}}(function(){return function(){return function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[a]={exports:{}};t[a][0].call(d.exports,function(e){return i(t[a][1][e]||e)},d,d.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}}()({1:[function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.ClrS=r.infoHandlersMap=r.infoHandlers=void 0;var i=e("./effectsHelpers"),o=e("./helpers"),a=e("./psdReader"),s=e("./psdWriter"),l=e("./descriptor"),u=e("./engineData"),d=e("./text"),c=e("base64-js");function f(e,t,n,i){var o={key:e,has:t,read:n,write:i};r.infoHandlers.push(o),r.infoHandlersMap[o.key]=o}r.infoHandlers=[],r.infoHandlersMap={};var h=o.createEnum("textGridding","none",{none:"None"}),p=o.createEnum("Ornt","horizontal",{horizontal:"Hrzn",vertical:"Vrtc"}),v=o.createEnum("Annt","sharp",{none:"Anno",sharp:"antiAliasSharp",crisp:"AnCr",strong:"AnSt",smooth:"AnSm"}),g=o.createEnum("warpStyle","none",{none:"warpNone",arc:"warpArc",arcLower:"warpArcLower",arcUpper:"warpArcUpper",arch:"warpArch",bulge:"warpBulge",shellLower:"warpShellLower",shellUpper:"warpShellUpper",flag:"warpFlag",wave:"warpWave",fish:"warpFish",rise:"warpRise",fisheye:"warpFisheye",inflate:"warpInflate",squeeze:"warpSqueeze",twist:"warpTwist"}),w=o.createEnum("BlnM","normal",{normal:"Nrml",dissolve:"Dslv",darken:"Drkn",multiply:"Mltp","color burn":"CBrn","linear burn":"linearBurn","darker color":"darkerColor",lighten:"Lghn",screen:"Scrn","color dodge":"CDdg","linear dodge":"linearDodge","lighter color":"lighterColor",overlay:"Ovrl","soft light":"SftL","hard light":"HrdL","vivid light":"vividLight","linear light":"linearLight","pin light":"pinLight","hard mix":"hardMix",difference:"Dfrn",exclusion:"Xclu",subtract:"blendSubtraction",divide:"blendDivide",hue:"H   ",saturation:"Strt",color:"Clr ",luminosity:"Lmns"}),y=o.createEnum("BESl","inner bevel",{"inner bevel":"InrB","outer bevel":"OtrB",emboss:"Embs","pillow emboss":"PlEb","stroke emboss":"strokeEmboss"}),m=o.createEnum("bvlT","smooth",{smooth:"SfBL","chisel hard":"PrBL","chisel soft":"Slmt"}),b=o.createEnum("BESs","up",{up:"In  ",down:"Out "}),S=o.createEnum("BETE","softer",{softer:"SfBL",precise:"PrBL"}),k=o.createEnum("IGSr","edge",{edge:"SrcE",center:"SrcC"}),U=o.createEnum("GrdT","linear",{linear:"Lnr ",radial:"Rdl ",angle:"Angl",reflected:"Rflc",diamond:"Dmnd"});r.ClrS=o.createEnum("ClrS","rgb",{rgb:"RGBC",hsb:"HSBl",lab:"LbCl"});var I,C,F=o.createEnum("FStl","outside",{outside:"OutF",center:"CtrF",inside:"InsF"}),P=o.createEnum("FrFl","color",{color:"SClr",gradient:"GrFl",pattern:"Ptrn"}),M=o.createEnum("strokeStyleLineCapType","butt",{butt:"strokeStyleButtCap",round:"strokeStyleRoundCap",square:"strokeStyleSquareCap"}),B=o.createEnum("strokeStyleLineJoinType","miter",{miter:"strokeStyleMiterJoin",round:"strokeStyleRoundJoin",bevel:"strokeStyleBevelJoin"}),D=o.createEnum("strokeStyleLineAlignment","inside",{inside:"strokeStyleAlignInside",center:"strokeStyleAlignCenter",outside:"strokeStyleAlignOutside"});function A(e){return function(t){return void 0!==t[e]}}function E(e,t,r){var n=a.readFixedPointPath32(e)*r,i=a.readFixedPointPath32(e)*t,o=a.readFixedPointPath32(e)*r,s=a.readFixedPointPath32(e)*t,l=a.readFixedPointPath32(e)*r;return[i,n,s,o,a.readFixedPointPath32(e)*t,l]}function x(e){return function(t){return!!t.adjustment&&t.adjustment.type===e}}function L(e){return{shadowInput:a.readInt16(e),highlightInput:a.readInt16(e),shadowOutput:a.readInt16(e),highlightOutput:a.readInt16(e),midtoneInput:a.readInt16(e)/100}}function T(e,t){s.writeInt16(e,t.shadowInput),s.writeInt16(e,t.highlightInput),s.writeInt16(e,t.shadowOutput),s.writeInt16(e,t.highlightOutput),s.writeInt16(e,Math.round(100*t.midtoneInput))}function O(e){for(var t=a.readUint16(e),r=[],n=0;n<t;n++){var i=a.readInt16(e),o=a.readInt16(e);r.push({input:o,output:i})}return r}function R(e,t){s.writeUint16(e,t.length);for(var r=0,n=t;r<n.length;r++){var i=n[r];s.writeUint16(e,i.output),s.writeUint16(e,i.input)}}function G(e){return{a:a.readInt16(e),b:a.readInt16(e),c:a.readInt16(e),d:a.readInt16(e),hue:a.readInt16(e),saturation:a.readInt16(e),lightness:a.readInt16(e)}}function j(e,t){var r=t||{};s.writeInt16(e,r.a||0),s.writeInt16(e,r.b||0),s.writeInt16(e,r.c||0),s.writeInt16(e,r.d||0),s.writeInt16(e,r.hue||0),s.writeInt16(e,r.saturation||0),s.writeInt16(e,r.lightness||0)}function N(e){return{cyanRed:a.readInt16(e),magentaGreen:a.readInt16(e),yellowBlue:a.readInt16(e)}}function z(e,t){s.writeInt16(e,t.cyanRed||0),s.writeInt16(e,t.magentaGreen||0),s.writeInt16(e,t.yellowBlue||0)}function V(e){var t=a.readInt16(e),r=a.readInt16(e),n=a.readInt16(e);return a.skipBytes(e,2),{red:t,green:r,blue:n,constant:a.readInt16(e)}}function _(e,t){var r=t||{};s.writeInt16(e,r.red),s.writeInt16(e,r.green),s.writeInt16(e,r.blue),s.writeZeros(e,2),s.writeInt16(e,r.constant)}f("TySh",A("text"),function(e,t,r){if(1!==a.readInt16(e))throw new Error("Invalid TySh version");for(var i=[],o=0;o<6;o++)i.push(a.readFloat64(e));if(50!==a.readInt16(e))throw new Error("Invalid TySh text version");var s=l.readVersionAndDescriptor(e);if(1!==a.readInt16(e))throw new Error("Invalid TySh warp version");var c=l.readVersionAndDescriptor(e);if(t.text={transform:i,left:a.readFloat32(e),top:a.readFloat32(e),right:a.readFloat32(e),bottom:a.readFloat32(e),text:s["Txt "].replace(/\r/g,"\n"),index:s.TextIndex||0,gridding:h.decode(s.textGridding),antiAlias:v.decode(s.AntA),orientation:p.decode(s.Ornt),warp:{style:g.decode(c.warpStyle),value:c.warpValue||0,perspective:c.warpPerspective||0,perspectiveOther:c.warpPerspectiveOther||0,rotate:p.decode(c.warpRotate)}},s.EngineData){var f=d.decodeEngineData(u.parseEngineData(s.EngineData));t.text=n(n({},t.text),f)}a.skipBytes(e,r())},function(e,t){var r=t.text,n=r.warp||{},i=r.transform||[1,0,0,1,0,0],o={"Txt ":(r.text||"").replace(/\r?\n/g,"\r"),textGridding:h.encode(r.gridding),Ornt:p.encode(r.orientation),AntA:v.encode(r.antiAlias),TextIndex:r.index||0,EngineData:u.serializeEngineData(d.encodeEngineData(r))},a={warpStyle:g.encode(n.style),warpValue:n.value||0,warpPerspective:n.perspective||0,warpPerspectiveOther:n.perspectiveOther||0,warpRotate:p.encode(n.rotate)};s.writeInt16(e,1);for(var c=0;c<6;c++)s.writeFloat64(e,i[c]);s.writeInt16(e,50),l.writeVersionAndDescriptor(e,"","TxLr",o),s.writeInt16(e,1),l.writeVersionAndDescriptor(e,"","warp",a),s.writeFloat32(e,r.left),s.writeFloat32(e,r.top),s.writeFloat32(e,r.right),s.writeFloat32(e,r.bottom)}),f("SoCo",function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"color"===e.vectorFill.type},function(e,t){var r=l.readVersionAndDescriptor(e);t.vectorFill=ee(r)},function(e,t){var r=ne(t.vectorFill).descriptor;l.writeVersionAndDescriptor(e,"","null",r)}),f("GdFl",function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&("solid"===e.vectorFill.type||"noise"===e.vectorFill.type)},function(e,t){var r=l.readVersionAndDescriptor(e);t.vectorFill=ee(r)},function(e,t){var r=ne(t.vectorFill).descriptor;l.writeVersionAndDescriptor(e,"","null",r)}),f("PtFl",function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"pattern"===e.vectorFill.type},function(e,t){var r=l.readVersionAndDescriptor(e);t.vectorFill=ee(r)},function(e,t){var r=ne(t.vectorFill).descriptor;l.writeVersionAndDescriptor(e,"","null",r)}),f("vscg",function(e){return void 0!==e.vectorFill&&void 0!==e.vectorStroke},function(e,t,r){a.readSignature(e);var n=l.readVersionAndDescriptor(e);t.vectorFill=ee(n),a.skipBytes(e,r())},function(e,t){var r=ne(t.vectorFill),n=r.descriptor,i=r.key;s.writeSignature(e,i),l.writeVersionAndDescriptor(e,"","null",n)}),f("vmsk",A("vectorMask"),function(e,t,r,n){var i=n.width,o=n.height;if(3!==a.readUint32(e))throw new Error("Invalid vmsk version");t.vectorMask={paths:[]};var s=t.vectorMask,l=a.readUint32(e);s.invert=0!=(1&l),s.notLink=0!=(2&l),s.disable=0!=(4&l);for(var u=s.paths,d=void 0;r()>=26;){switch(a.readUint16(e)){case 0:a.readUint16(e),a.skipBytes(e,22),d={open:!1,knots:[]},u.push(d);break;case 1:case 4:d.knots.push({linked:!0,points:E(e,i,o)});break;case 2:case 5:d.knots.push({linked:!1,points:E(e,i,o)});break;case 3:a.readUint16(e),a.skipBytes(e,22),d={open:!0,knots:[]},u.push(d);break;case 6:a.skipBytes(e,24);break;case 7:var c=a.readFixedPointPath32(e),f=a.readFixedPointPath32(e),h=a.readFixedPointPath32(e),p=a.readFixedPointPath32(e),v=a.readFixedPointPath32(e);a.skipBytes(e,4),s.clipboard={top:c,left:f,bottom:h,right:p,resolution:v};break;case 8:s.fillStartsWithAllPixels=!!a.readUint16(e),a.skipBytes(e,22);break;default:throw new Error("Invalid vmsk section")}}a.skipBytes(e,r())},function(e,t,r){var n=r.width,i=r.height,o=t.vectorMask,a=(o.invert?1:0)|(o.notLink?2:0)|(o.disable?4:0);s.writeUint32(e,3),s.writeUint32(e,a),s.writeUint16(e,6),s.writeZeros(e,24);var l=o.clipboard;l&&(s.writeUint16(e,7),s.writeFixedPointPath32(e,l.top),s.writeFixedPointPath32(e,l.left),s.writeFixedPointPath32(e,l.bottom),s.writeFixedPointPath32(e,l.right),s.writeFixedPointPath32(e,l.resolution),s.writeZeros(e,4)),void 0!==o.fillStartsWithAllPixels&&(s.writeUint16(e,8),s.writeUint16(e,o.fillStartsWithAllPixels?1:0),s.writeZeros(e,22));for(var u=0,d=o.paths;u<d.length;u++){var c=d[u];s.writeUint16(e,c.open?3:0),s.writeUint16(e,c.knots.length),s.writeUint16(e,1),s.writeUint16(e,1),s.writeZeros(e,18);for(var f=c.open?4:1,h=c.open?5:2,p=0,v=c.knots;p<v.length;p++){var g=v[p],w=g.linked,y=g.points;s.writeUint16(e,w?f:h),s.writeFixedPointPath32(e,y[1]/n),s.writeFixedPointPath32(e,y[0]/i),s.writeFixedPointPath32(e,y[3]/n),s.writeFixedPointPath32(e,y[2]/i),s.writeFixedPointPath32(e,y[5]/n),s.writeFixedPointPath32(e,y[4]/i)}}}),I="vsms",C="vmsk",r.infoHandlersMap[I]=r.infoHandlersMap[C],f("luni",A("name"),function(e,t,r){t.name=a.readUnicodeString(e),a.skipBytes(e,r())},function(e,t){s.writeUnicodeString(e,t.name)}),f("lnsr",A("nameSource"),function(e,t){return t.nameSource=a.readSignature(e)},function(e,t){return s.writeSignature(e,t.nameSource)}),f("lyid",A("id"),function(e,t){return t.id=a.readUint32(e)},function(e,t){return s.writeUint32(e,t.id)}),f("clbl",A("blendClippendElements"),function(e,t){t.blendClippendElements=!!a.readUint8(e),a.skipBytes(e,3)},function(e,t){s.writeUint8(e,t.blendClippendElements?1:0),s.writeZeros(e,3)}),f("infx",A("blendInteriorElements"),function(e,t){t.blendInteriorElements=!!a.readUint8(e),a.skipBytes(e,3)},function(e,t){s.writeUint8(e,t.blendInteriorElements?1:0),s.writeZeros(e,3)}),f("knko",A("knockout"),function(e,t){t.knockout=!!a.readUint8(e),a.skipBytes(e,3)},function(e,t){s.writeUint8(e,t.knockout?1:0),s.writeZeros(e,3)}),f("lspf",A("protected"),function(e,t){var r=a.readUint32(e);t.protected={transparency:0!=(1&r),composite:0!=(2&r),position:0!=(4&r)}},function(e,t){var r=(t.protected.transparency?1:0)|(t.protected.composite?2:0)|(t.protected.position?4:0);s.writeUint32(e,r)}),f("lclr",A("layerColor"),function(e,t){var r=a.readUint16(e);a.skipBytes(e,6),t.layerColor=o.layerColors[r]},function(e,t){var r=o.layerColors.indexOf(t.layerColor);s.writeUint16(e,-1===r?0:r),s.writeZeros(e,6)}),f("shmd",A("timestamp"),function(e,t,r,n,i){for(var o=a.readUint32(e),s=function(r){a.checkSignature(e,"8BIM");var n=a.readSignature(e);a.readUint8(e),a.skipBytes(e,3),a.readSection(e,1,function(r){if("cust"===n)void 0!==(o=l.readVersionAndDescriptor(e)).layerTime&&(t.timestamp=o.layerTime);else if("mlst"===n){var o=l.readVersionAndDescriptor(e);i.logDevFeatures&&console.log("mlst",o)}else if("mdyn"===n){var s=a.readUint16(e),u=a.readUint8(e),d=a.readUint8(e),c=0!=(1&d),f=0!=(2&d),h=0!=(4&d);i.logDevFeatures&&console.log("mdyn","unknown:",s,"propagate:",u,"flags:",d,{unifyLayerPosition:c,unifyLayerStyle:f,unifyLayerVisibility:h})}else i.logDevFeatures&&console.log("Unhandled metadata",n);a.skipBytes(e,r())})},u=0;u<o;u++)s();a.skipBytes(e,r())},function(e,t){var r={layerTime:t.timestamp};s.writeUint32(e,1),s.writeSignature(e,"8BIM"),s.writeSignature(e,"cust"),s.writeUint8(e,0),s.writeZeros(e,3),s.writeSection(e,2,function(){return l.writeVersionAndDescriptor(e,"","metadata",r)})}),f("sn2P",A("usingAlignedRendering"),function(e,t){return t.usingAlignedRendering=!!a.readUint32(e)},function(e,t){return s.writeUint32(e,t.usingAlignedRendering?1:0)}),f("fxrp",A("referencePoint"),function(e,t){t.referencePoint={x:a.readFloat64(e),y:a.readFloat64(e)}},function(e,t){s.writeFloat64(e,t.referencePoint.x),s.writeFloat64(e,t.referencePoint.y)}),f("lsct",A("sectionDivider"),function(e,t,r){t.sectionDivider={type:a.readUint32(e)},r()&&(a.checkSignature(e,"8BIM"),t.sectionDivider.key=a.readSignature(e)),r()&&(t.sectionDivider.subType=a.readUint32(e))},function(e,t){s.writeUint32(e,t.sectionDivider.type),t.sectionDivider.key&&(s.writeSignature(e,"8BIM"),s.writeSignature(e,t.sectionDivider.key),void 0!==t.sectionDivider.subType&&s.writeUint32(e,t.sectionDivider.subType))}),f("Patt",function(e){return!e},function(e,t,r){r()&&a.skipBytes(e,r())},function(e,t){}),f("pths",A("pathList"),function(e,t){l.readVersionAndDescriptor(e);t.pathList=[]},function(e,t){l.writeVersionAndDescriptor(e,"","pathsDataClass",{pathList:[]})}),f("lyvr",A("version"),function(e,t){return t.version=a.readUint32(e)},function(e,t){return s.writeUint32(e,t.version)}),f("lrFX",A("effects"),function(e,t,r){t.effects||(t.effects=i.readEffects(e)),a.skipBytes(e,r())},function(e,t){i.writeEffects(e,t.effects)}),f("brit",x("brightness/contrast"),function(e,t,r){t.adjustment||(t.adjustment={type:"brightness/contrast",brightness:a.readInt16(e),contrast:a.readInt16(e),meanValue:a.readInt16(e),labColorOnly:!!a.readUint8(e),useLegacy:!0}),a.skipBytes(e,r())},function(e,t){var r,n=t.adjustment;s.writeInt16(e,n.brightness||0),s.writeInt16(e,n.contrast||0),s.writeInt16(e,null!==(r=n.meanValue)&&void 0!==r?r:127),s.writeUint8(e,n.labColorOnly?1:0),s.writeZeros(e,1)}),f("levl",x("levels"),function(e,t,r){if(2!==a.readUint16(e))throw new Error("Invalid levl version");t.adjustment=n(n({},t.adjustment),{type:"levels",rgb:L(e),red:L(e),green:L(e),blue:L(e)}),a.skipBytes(e,r())},function(e,t){var r=t.adjustment,n={shadowInput:0,highlightInput:255,shadowOutput:0,highlightOutput:255,midtoneInput:1};s.writeUint16(e,2),T(e,r.rgb||n),T(e,r.red||n),T(e,r.blue||n),T(e,r.green||n);for(var i=0;i<59;i++)T(e,n)}),f("curv",x("curves"),function(e,t,r){if(a.readUint8(e),1!==a.readUint16(e))throw new Error("Invalid curv version");a.readUint16(e);var i=a.readUint16(e),o={type:"curves"};1&i&&(o.rgb=O(e)),2&i&&(o.red=O(e)),4&i&&(o.green=O(e)),8&i&&(o.blue=O(e)),t.adjustment=n(n({},t.adjustment),o),a.skipBytes(e,r())},function(e,t){var r=t.adjustment,n=r.rgb,i=r.red,o=r.green,a=r.blue,l=0,u=0;n&&n.length&&(l|=1,u++),i&&i.length&&(l|=2,u++),o&&o.length&&(l|=4,u++),a&&a.length&&(l|=8,u++),s.writeUint8(e,0),s.writeUint16(e,1),s.writeUint16(e,0),s.writeUint16(e,l),n&&n.length&&R(e,n),i&&i.length&&R(e,i),o&&o.length&&R(e,o),a&&a.length&&R(e,a),s.writeSignature(e,"Crv "),s.writeUint16(e,4),s.writeUint16(e,0),s.writeUint16(e,u),n&&n.length&&(s.writeUint16(e,0),R(e,n)),i&&i.length&&(s.writeUint16(e,1),R(e,i)),o&&o.length&&(s.writeUint16(e,2),R(e,o)),a&&a.length&&(s.writeUint16(e,3),R(e,a)),s.writeZeros(e,2)}),f("expA",x("exposure"),function(e,t,r){if(1!==a.readUint16(e))throw new Error("Invalid expA version");t.adjustment=n(n({},t.adjustment),{type:"exposure",exposure:a.readFloat32(e),offset:a.readFloat32(e),gamma:a.readFloat32(e)}),a.skipBytes(e,r())},function(e,t){var r=t.adjustment;s.writeUint16(e,1),s.writeFloat32(e,r.exposure),s.writeFloat32(e,r.offset),s.writeFloat32(e,r.gamma),s.writeZeros(e,2)}),f("vibA",x("vibrance"),function(e,t,r){var n=l.readVersionAndDescriptor(e);t.adjustment={type:"vibrance"},void 0!==n.vibrance&&(t.adjustment.vibrance=n.vibrance),void 0!==n.Strt&&(t.adjustment.saturation=n.Strt),a.skipBytes(e,r())},function(e,t){var r=t.adjustment,n={};void 0!==r.vibrance&&(n.vibrance=r.vibrance),void 0!==r.saturation&&(n.Strt=r.saturation),l.writeVersionAndDescriptor(e,"","null",n)}),f("hue2",x("hue/saturation"),function(e,t,r){if(2!==a.readUint16(e))throw new Error("Invalid hue2 version");t.adjustment=n(n({},t.adjustment),{type:"hue/saturation",master:G(e),reds:G(e),yellows:G(e),greens:G(e),cyans:G(e),blues:G(e),magentas:G(e)}),a.skipBytes(e,r())},function(e,t){var r=t.adjustment;s.writeUint16(e,2),j(e,r.master),j(e,r.reds),j(e,r.yellows),j(e,r.greens),j(e,r.cyans),j(e,r.blues),j(e,r.magentas)}),f("blnc",x("color balance"),function(e,t,r){t.adjustment={type:"color balance",shadows:N(e),midtones:N(e),highlights:N(e),preserveLuminosity:!!a.readUint8(e)},a.skipBytes(e,r())},function(e,t){var r=t.adjustment;z(e,r.shadows||{}),z(e,r.midtones||{}),z(e,r.highlights||{}),s.writeUint8(e,r.preserveLuminosity?1:0),s.writeZeros(e,1)}),f("blwh",x("black & white"),function(e,t,r){var n=l.readVersionAndDescriptor(e);t.adjustment={type:"black & white",reds:n["Rd  "],yellows:n.Yllw,greens:n["Grn "],cyans:n["Cyn "],blues:n["Bl  "],magentas:n.Mgnt,useTint:!!n.useTint,presetKind:n.bwPresetKind,presetFileName:n.blackAndWhitePresetFileName},void 0!==n.tintColor&&(t.adjustment.tintColor=de(n.tintColor)),a.skipBytes(e,r())},function(e,t){var r=t.adjustment,n={"Rd  ":r.reds||0,Yllw:r.yellows||0,"Grn ":r.greens||0,"Cyn ":r.cyans||0,"Bl  ":r.blues||0,Mgnt:r.magentas||0,useTint:!!r.useTint,tintColor:ce(r.tintColor),bwPresetKind:r.presetKind||0,blackAndWhitePresetFileName:r.presetFileName||""};l.writeVersionAndDescriptor(e,"","null",n)}),f("phfl",x("photo filter"),function(e,t,r){var n,i=a.readUint16(e);if(2!==i&&3!==i)throw new Error("Invalid phfl version");n=2===i?a.readColor(e):{l:a.readInt32(e)/100,a:a.readInt32(e)/100,b:a.readInt32(e)/100},t.adjustment={type:"photo filter",color:n,density:a.readUint32(e)/100,preserveLuminosity:!!a.readUint8(e)},a.skipBytes(e,r())},function(e,t){var r=t.adjustment;s.writeUint16(e,2),s.writeColor(e,r.color||{l:0,a:0,b:0}),s.writeUint32(e,100*(r.density||0)),s.writeUint8(e,r.preserveLuminosity?1:0),s.writeZeros(e,3)}),f("mixr",x("channel mixer"),function(e,t,r){if(1!==a.readUint16(e))throw new Error("Invalid mixr version");var i=t.adjustment=n(n({},t.adjustment),{type:"channel mixer",monochrome:!!a.readUint16(e)});i.monochrome||(i.red=V(e),i.green=V(e),i.blue=V(e)),i.gray=V(e),a.skipBytes(e,r())},function(e,t){var r=t.adjustment;s.writeUint16(e,1),s.writeUint16(e,r.monochrome?1:0),r.monochrome?(_(e,r.gray),s.writeZeros(e,30)):(_(e,r.red),_(e,r.green),_(e,r.blue),_(e,r.gray))});var W=o.createEnum("colorLookupType","3DLUT",{"3dlut":"3DLUT",abstractProfile:"abstractProfile",deviceLinkProfile:"deviceLinkProfile"}),H=o.createEnum("LUTFormatType","look",{look:"LUTFormatLOOK",cube:"LUTFormatCUBE","3dl":"LUTFormat3DL"}),X=o.createEnum("colorLookupOrder","rgb",{rgb:"rgbOrder",bgr:"bgrOrder"});f("clrL",x("color lookup"),function(e,t,r){if(1!==a.readUint16(e))throw new Error("Invalid clrL version");var n=l.readVersionAndDescriptor(e);t.adjustment={type:"color lookup"};var i=t.adjustment;void 0!==n.lookupType&&(i.lookupType=W.decode(n.lookupType)),void 0!==n["Nm  "]&&(i.name=n["Nm  "]),void 0!==n.Dthr&&(i.dither=n.Dthr),void 0!==n.profile&&(i.profile=n.profile),void 0!==n.LUTFormat&&(i.lutFormat=H.decode(n.LUTFormat)),void 0!==n.dataOrder&&(i.dataOrder=X.decode(n.dataOrder)),void 0!==n.tableOrder&&(i.tableOrder=X.decode(n.tableOrder)),void 0!==n.LUT3DFileData&&(i.lut3DFileData=n.LUT3DFileData),void 0!==n.LUT3DFileName&&(i.lut3DFileName=n.LUT3DFileName),a.skipBytes(e,r())},function(e,t){var r=t.adjustment,n={};void 0!==r.lookupType&&(n.lookupType=W.encode(r.lookupType)),void 0!==r.name&&(n["Nm  "]=r.name),void 0!==r.dither&&(n.Dthr=r.dither),void 0!==r.profile&&(n.profile=r.profile),void 0!==r.lutFormat&&(n.LUTFormat=H.encode(r.lutFormat)),void 0!==r.dataOrder&&(n.dataOrder=X.encode(r.dataOrder)),void 0!==r.tableOrder&&(n.tableOrder=X.encode(r.tableOrder)),void 0!==r.lut3DFileData&&(n.LUT3DFileData=r.lut3DFileData),void 0!==r.lut3DFileName&&(n.LUT3DFileName=r.lut3DFileName),s.writeUint16(e,1),l.writeVersionAndDescriptor(e,"","null",n)}),f("nvrt",x("invert"),function(e,t,r){t.adjustment={type:"invert"},a.skipBytes(e,r())},function(){}),f("post",x("posterize"),function(e,t,r){t.adjustment={type:"posterize",levels:a.readUint16(e)},a.skipBytes(e,r())},function(e,t){var r,n=t.adjustment;s.writeUint16(e,null!==(r=n.levels)&&void 0!==r?r:4),s.writeZeros(e,2)}),f("thrs",x("threshold"),function(e,t,r){t.adjustment={type:"threshold",level:a.readUint16(e)},a.skipBytes(e,r())},function(e,t){var r,n=t.adjustment;s.writeUint16(e,null!==(r=n.level)&&void 0!==r?r:128),s.writeZeros(e,2)});var K=["","","","rgb","hsb","","lab"];function Z(e){return{c:a.readInt16(e),m:a.readInt16(e),y:a.readInt16(e),k:a.readInt16(e)}}function Y(e,t){var r=t||{};s.writeInt16(e,r.c),s.writeInt16(e,r.m),s.writeInt16(e,r.y),s.writeInt16(e,r.k)}function J(e){if("GrdF.CstS"===e.GrdF){var t=e.Intr||4096;return{type:"solid",name:e["Nm  "],smoothness:e.Intr/4096,colorStops:e.Clrs.map(function(e){return{color:de(e["Clr "]),location:e.Lctn/t,midpoint:e.Mdpn/100}}),opacityStops:e.Trns.map(function(e){return{opacity:oe(e.Opct),location:e.Lctn/t,midpoint:e.Mdpn/100}})}}return{type:"noise",name:e["Nm  "],roughness:e.Smth/4096,colorModel:r.ClrS.decode(e.ClrS),randomSeed:e.RndS,restrictColors:!!e.VctC,addTransparency:!!e.ShTr,min:e["Mnm "].map(function(e){return e/100}),max:e["Mxm "].map(function(e){return e/100})}}function q(e){var t,n;if("solid"===e.type){var i=Math.round(4096*(null!==(t=e.smoothness)&&void 0!==t?t:1));return{GrdF:"GrdF.CstS","Nm  ":e.name,Intr:i,Clrs:e.colorStops.map(function(e){var t;return{"Clr ":ce(e.color),Type:"Clry.UsrS",Lctn:Math.round(e.location*i),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}}),Trns:e.opacityStops.map(function(e){var t;return{Opct:le(e.opacity),Lctn:Math.round(e.location*i),Mdpn:Math.round(100*(null!==(t=e.midpoint)&&void 0!==t?t:.5))}})}}return{GrdF:"GrdF.ClNs","Nm  ":e.name,ShTr:!!e.addTransparency,VctC:!!e.restrictColors,ClrS:r.ClrS.encode(e.colorModel),RndS:e.randomSeed||0,Smth:Math.round(4096*(null!==(n=e.roughness)&&void 0!==n?n:1)),"Mnm ":(e.min||[0,0,0,0]).map(function(e){return 100*e}),"Mxm ":(e.max||[1,1,1,1]).map(function(e){return 100*e})}}function $(e){var t=J(e.Grad);return t.style=U.decode(e.Type),void 0!==e.Dthr&&(t.dither=e.Dthr),void 0!==e.Rvrs&&(t.reverse=e.Rvrs),void 0!==e.Angl&&(t.angle=ie(e.Angl)),void 0!==e["Scl "]&&(t.scale=oe(e["Scl "])),void 0!==e.Algn&&(t.align=e.Algn),void 0!==e.Ofst&&(t.offset={x:oe(e.Ofst.Hrzn),y:oe(e.Ofst.Vrtc)}),t}function Q(e){var t={name:e.Ptrn["Nm  "],id:e.Ptrn.Idnt};return void 0!==e.Lnkd&&(t.linked=e.Lnkd),void 0!==e.phase&&(t.phase={x:e.phase.Hrzn,y:e.phase.Vrtc}),t}function ee(e){if("Grad"in e)return $(e);if("Ptrn"in e)return n({type:"pattern"},Q(e));if("Clr "in e)return{type:"color",color:de(e["Clr "])};throw new Error("Invalid vector content")}function te(e){var t={Grad:q(e),Type:U.encode(e.style)};return void 0!==e.dither&&(t.Dthr=e.dither),void 0!==e.reverse&&(t.Rvrs=e.reverse),void 0!==e.angle&&(t.Angl=se(e.angle)),void 0!==e.scale&&(t["Scl "]=le(e.scale)),void 0!==e.align&&(t.Algn=e.align),e.offset&&(t.Ofst={Hrzn:le(e.offset.x),Vrtc:le(e.offset.y)}),t}function re(e){var t={Ptrn:{"Nm  ":e.name||"",Idnt:e.id||""}};return void 0!==e.linked&&(t.Lnkd=!!e.linked),void 0!==e.phase&&(t.phase={Hrzn:e.phase.x,Vrtc:e.phase.y}),t}function ne(e){return"color"===e.type?{key:"SoCo",descriptor:{"Clr ":ce(e.color)}}:"pattern"===e.type?{key:"PtFl",descriptor:re(e)}:{key:"GdFl",descriptor:te(e)}}function ie(e){if(void 0===e)return 0;if("Angle"!==e.units)throw new Error("Invalid units: "+e.units);return e.value}function oe(e){if(void 0===e)return 1;if("Percent"!==e.units)throw new Error("Invalid units: "+e.units);return e.value/100}function ae(e){var t=e.units,r=e.value;if("Pixels"!==t&&"Millimeters"!==t&&"Points"!==t&&"None"!==t&&"Picas"!==t&&"Inches"!==t&&"Centimeters"!==t)throw new Error("Invalid units: "+JSON.stringify({units:t,value:r}));return{value:r,units:t}}function se(e){return{units:"Angle",value:e||0}}function le(e){return{units:"Percent",value:Math.round(100*o.clamp(e||0,0,1))}}function ue(e,t){if(null==e)return{units:"Pixels",value:0};if("object"!=typeof e)throw new Error("Invalid value: "+JSON.stringify(e)+" (key: "+t+") (should have value and units)");var r=e.units,n=e.value;if("number"!=typeof n)throw new Error("Invalid value in "+JSON.stringify(e)+" (key: "+t+")");if("Pixels"!==r&&"Millimeters"!==r&&"Points"!==r&&"None"!==r&&"Picas"!==r&&"Inches"!==r&&"Centimeters"!==r)throw new Error("Invalid units in "+JSON.stringify(e)+" (key: "+t+")");return{units:r,value:n}}function de(e){if("H   "in e)return{h:oe(e["H   "]),s:e.Strt,b:e.Brgh};if("Rd  "in e)return{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]};if("Cyn "in e)return{c:e["Cyn "],m:e.Mgnt,y:e["Ylw "],k:e.Blck};if("Gry "in e)return{k:e["Gry "]};if("Lmnc"in e)return{l:e.Lmnc,a:e["A   "],b:e["B   "]};throw new Error("Unsupported color descriptor")}function ce(e){if(e){if("r"in e)return{"Rd  ":e.r||0,"Grn ":e.g||0,"Bl  ":e.b||0};if("h"in e)return{"H   ":le(e.h),Strt:e.s||0,Brgh:e.b||0};if("c"in e)return{"Cyn ":e.c||0,Mgnt:e.m||0,"Ylw ":e.y||0,Blck:e.k||0};if("l"in e)return{Lmnc:e.l||0,"A   ":e.a||0,"B   ":e.b||0};if("k"in e)return{"Gry ":e.k};throw new Error("Invalid color value")}return{"Rd  ":0,"Grn ":0,"Bl  ":0}}function fe(e,t){for(var r={},n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],a=e[o];switch(o){case"enab":r.enabled=!!a;break;case"uglg":r.useGlobalLight=!!a;break;case"AntA":r.antialiased=!!a;break;case"Algn":r.align=!!a;break;case"Dthr":r.dither=!!a;break;case"Invr":r.invert=!!a;break;case"Rvrs":r.reverse=!!a;break;case"Clr ":r.color=de(a);break;case"hglC":r.highlightColor=de(a);break;case"sdwC":r.shadowColor=de(a);break;case"Styl":r.position=F.decode(a);break;case"Md  ":r.blendMode=w.decode(a);break;case"hglM":r.highlightBlendMode=w.decode(a);break;case"sdwM":r.shadowBlendMode=w.decode(a);break;case"bvlS":r.style=y.decode(a);break;case"bvlD":r.direction=b.decode(a);break;case"bvlT":r.technique=m.decode(a);break;case"GlwT":r.technique=S.decode(a);break;case"glwS":r.source=k.decode(a);break;case"Type":r.type=U.decode(a);break;case"Opct":r.opacity=oe(a);break;case"hglO":r.highlightOpacity=oe(a);break;case"sdwO":r.shadowOpacity=oe(a);break;case"lagl":case"Angl":r.angle=ie(a);break;case"Lald":r.altitude=ie(a);break;case"Sftn":r.soften=ae(a);break;case"srgR":r.strength=oe(a);break;case"blur":r.size=ae(a);break;case"Nose":r.noise=oe(a);break;case"Inpr":r.range=oe(a);break;case"Ckmt":r.choke=ae(a);break;case"ShdN":r.jitter=oe(a);break;case"Dstn":r.distance=ae(a);break;case"Scl ":r.scale=oe(a);break;case"Ptrn":r.pattern={name:a["Nm  "],id:a.Idnt};break;case"phase":r.phase={x:a.Hrzn,y:a.Vrtc};break;case"Ofst":r.offset={x:oe(a.Hrzn),y:oe(a.Vrtc)};break;case"MpgS":case"TrnS":r.contour={name:a["Nm  "],curve:a["Crv "].map(function(e){return{x:e.Hrzn,y:e.Vrtc}})};break;case"Grad":r.gradient=J(a);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":r[o]=a;break;default:t&&console.log("Invalid effect key: '"+o+"':",a)}}return r}function he(e,t,r){for(var n={},i=0,o=Object.keys(e);i<o.length;i++){var a=o[i],s=e[a];switch(a){case"enabled":n.enab=!!s;break;case"useGlobalLight":n.uglg=!!s;break;case"antialiased":n.AntA=!!s;break;case"align":n.Algn=!!s;break;case"dither":n.Dthr=!!s;break;case"invert":n.Invr=!!s;break;case"reverse":n.Rvrs=!!s;break;case"color":n["Clr "]=ce(s);break;case"highlightColor":n.hglC=ce(s);break;case"shadowColor":n.sdwC=ce(s);break;case"position":n.Styl=F.encode(s);break;case"blendMode":n["Md  "]=w.encode(s);break;case"highlightBlendMode":n.hglM=w.encode(s);break;case"shadowBlendMode":n.sdwM=w.encode(s);break;case"style":n.bvlS=y.encode(s);break;case"direction":n.bvlD=b.encode(s);break;case"technique":"bevel"===t?n.bvlT=m.encode(s):n.GlwT=S.encode(s);break;case"source":n.glwS=k.encode(s);break;case"type":n.Type=U.encode(s);break;case"opacity":n.Opct=le(s);break;case"highlightOpacity":n.hglO=le(s);break;case"shadowOpacity":n.sdwO=le(s);break;case"angle":"gradientOverlay"===t?n.Angl=se(s):n.lagl=se(s);break;case"altitude":n.Lald=se(s);break;case"soften":n.Sftn=ue(s,a);break;case"strength":n.srgR=le(s);break;case"size":n.blur=ue(s,a);break;case"noise":n.Nose=le(s);break;case"range":n.Inpr=le(s);break;case"choke":n.Ckmt=ue(s,a);break;case"jitter":n.ShdN=le(s);break;case"distance":n.Dstn=ue(s,a);break;case"scale":n["Scl "]=le(s);break;case"pattern":n.Ptrn={"Nm  ":s.name,Idnt:s.id};break;case"phase":n.phase={Hrzn:s.x,Vrtc:s.y};break;case"offset":n.Ofst={Hrzn:le(s.x),Vrtc:le(s.y)};break;case"contour":n["satin"===t?"MpgS":"TrnS"]={"Nm  ":s.name,"Crv ":s.curve.map(function(e){return{Hrzn:e.x,Vrtc:e.y}})};break;case"gradient":n.Grad=q(s);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":n[a]=s;break;default:r&&console.log("Invalid effect key: '"+a+"' value:",s)}}return n}f("grdm",x("gradient map"),function(e,t,r){if(1!==a.readUint16(e))throw new Error("Invalid grdm version");var n={type:"gradient map",gradientType:"solid"};n.reverse=!!a.readUint8(e),n.dither=!!a.readUint8(e),n.name=a.readUnicodeString(e),n.colorStops=[],n.opacityStops=[];for(var i=a.readUint16(e),o=0;o<i;o++)n.colorStops.push({location:a.readUint32(e),midpoint:a.readUint32(e)/100,color:a.readColor(e)}),a.skipBytes(e,2);var s=a.readUint16(e);for(o=0;o<s;o++)n.opacityStops.push({location:a.readUint32(e),midpoint:a.readUint32(e)/100,opacity:a.readUint16(e)/255});if(2!==a.readUint16(e))throw new Error("Invalid grdm expansion count");var l=a.readUint16(e);if(n.smoothness=l/4096,32!==a.readUint16(e))throw new Error("Invalid grdm length");n.gradientType=a.readUint16(e)?"noise":"solid",n.randomSeed=a.readUint32(e),n.addTransparency=!!a.readUint16(e),n.restrictColors=!!a.readUint16(e),n.roughness=a.readUint32(e)/4096,n.colorModel=K[a.readUint16(e)]||"rgb",n.min=[a.readUint16(e)/32768,a.readUint16(e)/32768,a.readUint16(e)/32768,a.readUint16(e)/32768],n.max=[a.readUint16(e)/32768,a.readUint16(e)/32768,a.readUint16(e)/32768,a.readUint16(e)/32768],a.skipBytes(e,r());for(var u=0,d=n.colorStops;u<d.length;u++){d[u].location/=l}for(var c=0,f=n.opacityStops;c<f.length;c++){f[c].location/=l}t.adjustment=n},function(e,t){var r,n,i,o=t.adjustment;s.writeUint16(e,1),s.writeUint8(e,o.reverse?1:0),s.writeUint8(e,o.dither?1:0),s.writeUnicodeStringWithPadding(e,o.name||""),s.writeUint16(e,o.colorStops&&o.colorStops.length||0);for(var a=Math.round(4096*(null!==(r=o.smoothness)&&void 0!==r?r:1)),l=0,u=o.colorStops||[];l<u.length;l++){var d=u[l];s.writeUint32(e,Math.round(d.location*a)),s.writeUint32(e,Math.round(100*d.midpoint)),s.writeColor(e,d.color),s.writeZeros(e,2)}s.writeUint16(e,o.opacityStops&&o.opacityStops.length||0);for(var c=0,f=o.opacityStops||[];c<f.length;c++){d=f[c];s.writeUint32(e,Math.round(d.location*a)),s.writeUint32(e,Math.round(100*d.midpoint)),s.writeUint16(e,Math.round(255*d.opacity))}s.writeUint16(e,2),s.writeUint16(e,a),s.writeUint16(e,32),s.writeUint16(e,"noise"===o.gradientType?1:0),s.writeUint32(e,o.randomSeed||0),s.writeUint16(e,o.addTransparency?1:0),s.writeUint16(e,o.restrictColors?1:0),s.writeUint32(e,Math.round(4096*(null!==(n=o.roughness)&&void 0!==n?n:1)));var h=K.indexOf(null!==(i=o.colorModel)&&void 0!==i?i:"rgb");s.writeUint16(e,-1===h?3:h);for(var p=0;p<4;p++)s.writeUint16(e,Math.round(32768*(o.min&&o.min[p]||0)));for(p=0;p<4;p++)s.writeUint16(e,Math.round(32768*(o.max&&o.max[p]||0)));s.writeZeros(e,4)}),f("selc",x("selective color"),function(e,t){if(1!==a.readUint16(e))throw new Error("Invalid selc version");var r=a.readUint16(e)?"absolute":"relative";a.skipBytes(e,8),t.adjustment={type:"selective color",mode:r,reds:Z(e),yellows:Z(e),greens:Z(e),cyans:Z(e),blues:Z(e),magentas:Z(e),whites:Z(e),neutrals:Z(e),blacks:Z(e)}},function(e,t){var r=t.adjustment;s.writeUint16(e,1),s.writeUint16(e,"absolute"===r.mode?1:0),s.writeZeros(e,8),Y(e,r.reds),Y(e,r.yellows),Y(e,r.greens),Y(e,r.cyans),Y(e,r.blues),Y(e,r.magentas),Y(e,r.whites),Y(e,r.neutrals),Y(e,r.blacks)}),f("CgEd",function(e){var t=e.adjustment;return!!t&&("brightness/contrast"===t.type&&!t.useLegacy||("levels"===t.type||"curves"===t.type||"exposure"===t.type||"channel mixer"===t.type||"hue/saturation"===t.type)&&void 0!==t.presetFileName)},function(e,t,r){var i=l.readVersionAndDescriptor(e);if(1!==i.Vrsn)throw new Error("Invalid CgEd version");t.adjustment="presetFileName"in i?n(n({},t.adjustment),{presetKind:i.presetKind,presetFileName:i.presetFileName}):"curvesPresetFileName"in i?n(n({},t.adjustment),{presetKind:i.curvesPresetKind,presetFileName:i.curvesPresetFileName}):"mixerPresetFileName"in i?n(n({},t.adjustment),{presetKind:i.mixerPresetKind,presetFileName:i.mixerPresetFileName}):{type:"brightness/contrast",brightness:i.Brgh,contrast:i.Cntr,meanValue:i.means,useLegacy:!!i.useLegacy,labColorOnly:!!i["Lab "],auto:!!i.Auto},a.skipBytes(e,r())},function(e,t){var r,n,i,o,a=t.adjustment;if("levels"===a.type||"exposure"===a.type||"hue/saturation"===a.type){var s={Vrsn:1,presetKind:null!==(r=a.presetKind)&&void 0!==r?r:1,presetFileName:a.presetFileName||""};l.writeVersionAndDescriptor(e,"","null",s)}else if("curves"===a.type){s={Vrsn:1,curvesPresetKind:null!==(n=a.presetKind)&&void 0!==n?n:1,curvesPresetFileName:a.presetFileName||""};l.writeVersionAndDescriptor(e,"","null",s)}else if("channel mixer"===a.type){s={Vrsn:1,mixerPresetKind:null!==(i=a.presetKind)&&void 0!==i?i:1,mixerPresetFileName:a.presetFileName||""};l.writeVersionAndDescriptor(e,"","null",s)}else{if("brightness/contrast"!==a.type)throw new Error("Unhandled CgEd case");s={Vrsn:1,Brgh:a.brightness||0,Cntr:a.contrast||0,means:null!==(o=a.meanValue)&&void 0!==o?o:127,"Lab ":!!a.labColorOnly,useLegacy:!!a.useLegacy,Auto:!!a.auto};l.writeVersionAndDescriptor(e,"","null",s)}}),f("Txt2",A("engineData"),function(e,t,r){var n=a.readBytes(e,r());t.engineData=c.fromByteArray(n)},function(e,t){var r=c.toByteArray(t.engineData);s.writeBytes(e,r)}),f("FMsk",A("filterMask"),function(e,t){t.filterMask={colorSpace:a.readColor(e),opacity:a.readUint16(e)/255}},function(e,t){var r;s.writeColor(e,t.filterMask.colorSpace),s.writeUint16(e,255*o.clamp(null!==(r=t.filterMask.opacity)&&void 0!==r?r:1,0,1))}),f("vstk",A("vectorStroke"),function(e,t,r){var n=l.readVersionAndDescriptor(e);t.vectorStroke={strokeEnabled:n.strokeEnabled,fillEnabled:n.fillEnabled,lineWidth:ae(n.strokeStyleLineWidth),lineDashOffset:ae(n.strokeStyleLineDashOffset),miterLimit:n.strokeStyleMiterLimit,lineCapType:M.decode(n.strokeStyleLineCapType),lineJoinType:B.decode(n.strokeStyleLineJoinType),lineAlignment:D.decode(n.strokeStyleLineAlignment),scaleLock:n.strokeStyleScaleLock,strokeAdjust:n.strokeStyleStrokeAdjust,lineDashSet:n.strokeStyleLineDashSet.map(ae),blendMode:w.decode(n.strokeStyleBlendMode),opacity:oe(n.strokeStyleOpacity),content:ee(n.strokeStyleContent),resolution:n.strokeStyleResolution},a.skipBytes(e,r())},function(e,t){var r,n,i,o=t.vectorStroke,a={strokeStyleVersion:2,strokeEnabled:!!o.strokeEnabled,fillEnabled:!!o.fillEnabled,strokeStyleLineWidth:o.lineWidth||{value:3,units:"Points"},strokeStyleLineDashOffset:o.lineDashOffset||{value:0,units:"Points"},strokeStyleMiterLimit:null!==(r=o.miterLimit)&&void 0!==r?r:100,strokeStyleLineCapType:M.encode(o.lineCapType),strokeStyleLineJoinType:B.encode(o.lineJoinType),strokeStyleLineAlignment:D.encode(o.lineAlignment),strokeStyleScaleLock:!!o.scaleLock,strokeStyleStrokeAdjust:!!o.strokeAdjust,strokeStyleLineDashSet:o.lineDashSet||[],strokeStyleBlendMode:w.encode(o.blendMode),strokeStyleOpacity:le(null!==(n=o.opacity)&&void 0!==n?n:1),strokeStyleContent:ne(o.content||{type:"color",color:{r:0,g:0,b:0}}).descriptor,strokeStyleResolution:null!==(i=o.resolution)&&void 0!==i?i:72};l.writeVersionAndDescriptor(e,"","strokeStyle",a)}),f("lfx2",A("effects"),function(e,t,r,n,i){var o=!!i.logMissingFeatures;if(0!==a.readUint32(e))throw new Error("Invalid lfx2 version");var s=l.readVersionAndDescriptor(e);t.effects={};var u=t.effects;s.masterFXSwitch||(u.disabled=!0),s["Scl "]&&(u.scale=oe(s["Scl "])),s.DrSh&&(u.dropShadow=fe(s.DrSh,o)),s.IrSh&&(u.innerShadow=fe(s.IrSh,o)),s.OrGl&&(u.outerGlow=fe(s.OrGl,o)),s.IrGl&&(u.innerGlow=fe(s.IrGl,o)),s.ebbl&&(u.bevel=fe(s.ebbl,o)),s.SoFi&&(u.solidFill=fe(s.SoFi,o)),s.patternFill&&(u.patternOverlay=fe(s.patternFill,o)),s.GrFl&&(u.gradientOverlay=fe(s.GrFl,o)),s.ChFX&&(u.satin=fe(s.ChFX,o)),s.FrFX&&(u.stroke={enabled:!!s.FrFX.enab,position:F.decode(s.FrFX.Styl),fillType:P.decode(s.FrFX.PntT),blendMode:w.decode(s.FrFX["Md  "]),opacity:oe(s.FrFX.Opct),size:ae(s.FrFX["Sz  "])},s.FrFX["Clr "]&&(u.stroke.color=de(s.FrFX["Clr "])),s.FrFX.Grad&&(u.stroke.gradient=$(s.FrFX)),s.FrFX.Ptrn&&(u.stroke.pattern=Q(s.FrFX))),a.skipBytes(e,r())},function(e,t,r,i){var o,a=!!i.logMissingFeatures,u=t.effects,d={masterFXSwitch:!u.disabled,"Scl ":le(null!==(o=u.scale)&&void 0!==o?o:1)};u.dropShadow&&(d.DrSh=he(u.dropShadow,"dropShadow",a)),u.innerShadow&&(d.IrSh=he(u.innerShadow,"innerShadow",a)),u.outerGlow&&(d.OrGl=he(u.outerGlow,"outerGlow",a)),u.innerGlow&&(d.IrGl=he(u.innerGlow,"innerGlow",a)),u.bevel&&(d.ebbl=he(u.bevel,"bevel",a)),u.solidFill&&(d.SoFi=he(u.solidFill,"solidFill",a)),u.patternOverlay&&(d.patternFill=he(u.patternOverlay,"patternOverlay",a)),u.gradientOverlay&&(d.GrFl=he(u.gradientOverlay,"gradientOverlay",a)),u.satin&&(d.ChFX=he(u.satin,"satin",a));var c=u.stroke;c&&(d.FrFX={enab:!!c.enabled,Styl:F.encode(c.position),PntT:P.encode(c.fillType),"Md  ":w.encode(c.blendMode),Opct:le(c.opacity),"Sz  ":ue(c.size,"size")},c.color&&(d.FrFX["Clr "]=ce(c.color)),c.gradient&&(d.FrFX=n(n({},d.FrFX),te(c.gradient))),c.pattern&&(d.FrFX=n(n({},d.FrFX),re(c.pattern)))),s.writeUint32(e,0),l.writeVersionAndDescriptor(e,"","null",d)})},{"./descriptor":2,"./effectsHelpers":3,"./engineData":4,"./helpers":5,"./psdReader":9,"./psdWriter":10,"./text":11,"base64-js":13}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.writeVersionAndDescriptor=r.readVersionAndDescriptor=r.writeDescriptorStructure=r.readDescriptorStructure=r.readAsciiStringOrClassId=r.setLogErrors=void 0;var n=e("./psdReader"),i=e("./psdWriter");var o,a,s={"#Ang":"Angle","#Rsl":"Density","#Rlt":"Distance","#Nne":"None","#Prc":"Percent","#Pxl":"Pixels","#Mlm":"Millimeters","#Pnt":"Points",RrPi:"Picas",RrIn:"Inches",RrCm:"Centimeters"},l=(o=s,a={},Object.keys(o).forEach(function(e){return a[o[e]]=e}),a),u=!1;function d(e,t){return{name:e,classID:t}}r.setLogErrors=function(e){u=e};for(var c={strokeStyleContent:d("","solidColorLayer"),printProofSetup:d("Proof Setup","proofSetup"),patternFill:d("","patternFill"),Grad:d("Gradient","Grdn"),ebbl:d("","ebbl"),SoFi:d("","SoFi"),GrFl:d("","GrFl"),sdwC:d("","RGBC"),hglC:d("","RGBC"),"Clr ":d("","RGBC"),tintColor:d("","RGBC"),Ofst:d("","Pnt "),ChFX:d("","ChFX"),MpgS:d("","ShpC"),DrSh:d("","DrSh"),IrSh:d("","IrSh"),OrGl:d("","OrGl"),IrGl:d("","IrGl"),TrnS:d("","ShpC"),Ptrn:d("","Ptrn"),FrFX:d("","FrFX"),phase:d("","Pnt ")},f={"Crv ":d("","CrPt"),Clrs:d("","Clrt"),Trns:d("","TrnS")},h={TEXT:["Txt ","printerName","Nm  ","Idnt","blackAndWhitePresetFileName","LUT3DFileName","presetFileName","curvesPresetFileName","mixerPresetFileName"],tdta:["EngineData","LUT3DFileData"],long:["TextIndex","RndS","Mdpn","Smth","Lctn","strokeStyleVersion","LaID","Vrsn","Brgh","Cntr","means","vibrance","Strt","bwPresetKind","presetKind","curvesPresetKind","mixerPresetKind"],enum:["textGridding","Ornt","warpStyle","warpRotate","Inte","Bltn","ClrS","sdwM","hglM","bvlT","bvlS","bvlD","Md  ","Type","glwS","GrdF","GlwT","strokeStyleLineCapType","strokeStyleLineJoinType","strokeStyleLineAlignment","strokeStyleBlendMode","PntT","Styl","lookupType","LUTFormat","dataOrder","tableOrder"],bool:["PstS","printSixteenBit","masterFXSwitch","enab","uglg","antialiasGloss","useShape","useTexture","masterFXSwitch","uglg","antialiasGloss","useShape","useTexture","Algn","Rvrs","Dthr","Invr","VctC","ShTr","layerConceals","strokeEnabled","fillEnabled","strokeStyleScaleLock","strokeStyleStrokeAdjust","hardProof","MpBl","paperWhite","useLegacy","Auto","Lab ","useTint"],doub:["warpValue","warpPerspective","warpPerspectiveOther","Intr","strokeStyleMiterLimit","strokeStyleResolution","layerTime"],UntF:["Scl ","sdwO","hglO","lagl","Lald","srgR","blur","Sftn","Opct","Dstn","Angl","Ckmt","Nose","Inpr","ShdN","strokeStyleLineWidth","strokeStyleLineDashOffset","strokeStyleOpacity","Sz  ","H   "],VlLs:["Crv ","Clrs","Mnm ","Mxm ","Trns","pathList","strokeStyleLineDashSet","FrLs","LaSt"]},p=["Rd  ","Grn ","Bl  ","Yllw","Ylw ","Cyn ","Mgnt","Blck","Gry ","Lmnc","A   ","B   "],v={"Mnm ":"long","Mxm ":"long",FrLs:"long",strokeStyleLineDashSet:"UntF"},g={},w=0,y=Object.keys(h);w<y.length;w++)for(var m=y[w],b=0,S=h[m];b<S.length;b++){var k=S[b];g[k]=m}for(var U=0,I=Object.keys(c);U<I.length;U++){k=I[U];g[k]="Objc"}for(var C=0,F=Object.keys(f);C<F.length;C++){k=F[C];v[k]="Objc"}function P(e,t){return"AntA"===e?"string"==typeof t?"enum":"bool":"Hrzn"===e||"Vrtc"===e?"number"==typeof t?"doub":"UntF":g[e]}function M(e){var t=n.readInt32(e);return 0===t?n.readSignature(e):n.readAsciiString(e,t)}function B(e,t){if(4===t.length&&"warp"!==t)i.writeInt32(e,0),i.writeSignature(e,t);else{i.writeInt32(e,t.length);for(var r=0;r<t.length;r++)i.writeUint8(e,t.charCodeAt(r))}}function D(e){L(e);for(var t=n.readUint32(e),r={},i=0;i<t;i++){var o=M(e),a=E(e,n.readSignature(e));r[o]=a}return r}function A(e,t,r,n){u&&!r&&console.log("Missing classId for: ",t,r,n),i.writeUnicodeStringWithPadding(e,t),B(e,r);var o=Object.keys(n);i.writeUint32(e,o.length);for(var a=0,s=o;a<s.length;a++){var l=s[a],f=P(l,n[l]),h=c[l];-1!==p.indexOf(l)?f="RGBC"===r?"doub":"long":"profile"===l?f="printOutput"===r?"TEXT":"tdta":"strokeStyleContent"===l&&(n[l]["Clr "]?h=d("","solidColorLayer"):n[l].Grad?h=d("","gradientLayer"):n[l].Ptrn?h=d("","patternLayer"):u&&console.log("Invalid strokeStyleContent value",n[l])),B(e,l),i.writeSignature(e,f||"long"),x(e,f||"long",n[l],l,h),u&&!f&&console.log("Missing descriptor field type for: '"+l+"' in",n)}}function E(e,t){switch(t){case"obj ":return function(e){for(var t=n.readInt32(e),r=[],i=0;i<t;i++){var o=n.readSignature(e);switch(o){case"prop":var a=L(e),s=a.name,l=a.classID,u=M(e);r.push({name:s,classID:l,keyID:u});break;case"Clss":r.push(L(e));break;case"Enmr":var d=L(e),c=d.name,l=d.classID,f=M(e),h=M(e);r.push({name:c,classID:l,TypeID:f,value:h});break;case"rele":var p=L(e),v=p.name,l=p.classID,h=n.readUint32(e);r.push({name:v,classID:l,value:h});break;case"Idnt":case"indx":r.push(n.readInt32(e));break;case"name":r.push(n.readUnicodeString(e));break;default:throw new Error("Invalid TySh descriptor Reference type: "+o)}}return r}(e);case"Objc":case"GlbO":return D(e);case"VlLs":for(var r=n.readInt32(e),i=[],o=0;o<r;o++){var a=n.readSignature(e);i.push(E(e,a))}return i;case"doub":return n.readFloat64(e);case"UntF":var l=n.readSignature(e),u=n.readFloat64(e);if(!s[l])throw new Error("Invalid units: "+l);return{units:s[l],value:u};case"UnFl":l=n.readSignature(e),u=n.readFloat32(e);if(!s[l])throw new Error("Invalid units: "+l);return{units:s[l],value:u};case"TEXT":return n.readUnicodeString(e);case"enum":return M(e)+"."+(u=M(e));case"long":return n.readInt32(e);case"comp":return{low:n.readUint32(e),high:n.readUint32(e)};case"bool":return!!n.readUint8(e);case"type":case"GlbC":return L(e);case"alis":var d=n.readInt32(e);return n.readAsciiString(e,d);case"tdta":var c=n.readInt32(e);return n.readBytes(e,c);case"ObAr":throw new Error("not implemented: ObAr");case"Pth ":n.readInt32(e);var f=n.readSignature(e);n.readInt32LE(e);var h=n.readInt32LE(e);return{sig:f,path:n.readUnicodeStringWithLength(e,h)};default:throw new Error("Invalid TySh descriptor OSType: "+t+" at "+e.offset.toString(16))}}function x(e,t,r,n,o){switch(t){case"Objc":case"GlbO":if(!o)throw new Error("Missing ext type for: "+n+" ("+JSON.stringify(r)+")");A(e,o.name,o.classID,r);break;case"VlLs":i.writeInt32(e,r.length);for(var a=0;a<r.length;a++){var s=v[n];i.writeSignature(e,s||"long"),x(e,s||"long",r[a],"",f[n]),u&&!s&&console.log("Missing descriptor array type for: '"+n+"' in",r)}break;case"doub":i.writeFloat64(e,r);break;case"UntF":if(!l[r.units])throw new Error("Invalid units: "+r.units);i.writeSignature(e,l[r.units]),i.writeFloat64(e,r.value);break;case"UnFl":if(!l[r.units])throw new Error("Invalid units: "+r.units);i.writeSignature(e,l[r.units]),i.writeFloat32(e,r.value);break;case"TEXT":i.writeUnicodeStringWithPadding(e,r);break;case"enum":var d=r.split("."),c=d[0],h=d[1];B(e,c),B(e,h);break;case"long":i.writeInt32(e,r);break;case"bool":i.writeUint8(e,r?1:0);break;case"tdta":i.writeInt32(e,r.byteLength),i.writeBytes(e,r);break;default:throw new Error("Not implemented TySh descriptor OSType: "+t)}}function L(e){return{name:n.readUnicodeString(e),classID:M(e)}}r.readAsciiStringOrClassId=M,r.readDescriptorStructure=D,r.writeDescriptorStructure=A,r.readVersionAndDescriptor=function(e){if(16!==n.readUint32(e))throw new Error("Invalid descriptor version");return D(e)},r.writeVersionAndDescriptor=function(e,t,r,n){i.writeUint32(e,16),A(e,t,r,n)}},{"./psdReader":9,"./psdWriter":10}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.writeEffects=r.readEffects=void 0;var n=e("./helpers"),i=e("./psdReader"),o=e("./psdWriter"),a=[void 0,"outer bevel","inner bevel","emboss","pillow emboss","stroke emboss"];function s(e){return i.checkSignature(e,"8BIM"),n.toBlendMode[i.readSignature(e)]||"normal"}function l(e,t){o.writeSignature(e,"8BIM"),o.writeSignature(e,n.fromBlendMode[t]||"norm")}function u(e){return i.readUint8(e)/255}function d(e,t){o.writeUint8(e,0|Math.round(255*t))}function c(e,t){var r;o.writeUint32(e,51),o.writeUint32(e,2),o.writeFixedPoint32(e,t.size&&t.size.value||0),o.writeFixedPoint32(e,0),o.writeFixedPoint32(e,t.angle||0),o.writeFixedPoint32(e,t.distance&&t.distance.value||0),o.writeColor(e,t.color),l(e,t.blendMode),o.writeUint8(e,t.enabled?1:0),o.writeUint8(e,t.useGlobalLight?1:0),d(e,null!==(r=t.opacity)&&void 0!==r?r:1),o.writeColor(e,t.color)}r.readEffects=function(e){var t=i.readUint16(e);if(0!==t)throw new Error("Invalid effects layer version: "+t);for(var r=i.readUint16(e),n={},o=0;o<r;o++){i.checkSignature(e,"8BIM");var l=i.readSignature(e);switch(l){case"cmnS":var d=i.readUint32(e),c=i.readUint32(e),f=!!i.readUint8(e);if(i.skipBytes(e,2),7!==d||0!==c||!f)throw new Error("Invalid effects common state");break;case"dsdw":case"isdw":var h=i.readUint32(e),p=i.readUint32(e);if(41!==h&&51!==h)throw new Error("Invalid shadow size: "+h);if(0!==p&&2!==p)throw new Error("Invalid shadow version: "+p);d=i.readFixedPoint32(e),i.readFixedPoint32(e);var v=i.readFixedPoint32(e),g=i.readFixedPoint32(e),w=i.readColor(e),y=s(e),m=!!i.readUint8(e),b=!!i.readUint8(e),S=u(e);h>=51&&i.readColor(e);var k={size:{units:"Pixels",value:d},distance:{units:"Pixels",value:g},angle:v,color:w,blendMode:y,enabled:m,useGlobalLight:b,opacity:S};"dsdw"===l?n.dropShadow=k:n.innerShadow=k;break;case"oglw":h=i.readUint32(e);var U=i.readUint32(e);if(32!==h&&42!==h)throw new Error("Invalid outer glow size: "+h);if(0!==U&&2!==U)throw new Error("Invalid outer glow version: "+U);d=i.readFixedPoint32(e),i.readFixedPoint32(e),w=i.readColor(e),y=s(e),m=!!i.readUint8(e),S=u(e),h>=42&&i.readColor(e),n.outerGlow={size:{units:"Pixels",value:d},color:w,blendMode:y,enabled:m,opacity:S};break;case"iglw":h=i.readUint32(e);var I=i.readUint32(e);if(32!==h&&43!==h)throw new Error("Invalid inner glow size: "+h);if(0!==I&&2!==I)throw new Error("Invalid inner glow version: "+I);d=i.readFixedPoint32(e),i.readFixedPoint32(e),w=i.readColor(e),y=s(e),m=!!i.readUint8(e),S=u(e),h>=43&&(i.readUint8(e),i.readColor(e)),n.innerGlow={size:{units:"Pixels",value:d},color:w,blendMode:y,enabled:m,opacity:S};break;case"bevl":h=i.readUint32(e);var C=i.readUint32(e);if(58!==h&&78!==h)throw new Error("Invalid bevel size: "+h);if(0!==C&&2!==C)throw new Error("Invalid bevel version: "+C);v=i.readFixedPoint32(e);var F=i.readFixedPoint32(e),P=(d=i.readFixedPoint32(e),s(e)),M=s(e),B=i.readColor(e),D=i.readColor(e),A=a[i.readUint8(e)]||"inner bevel",E=u(e),x=u(e),L=(m=!!i.readUint8(e),b=!!i.readUint8(e),i.readUint8(e)?"down":"up");h>=78&&(i.readColor(e),i.readColor(e)),n.bevel={size:{units:"Pixels",value:d},angle:v,strength:F,highlightBlendMode:P,shadowBlendMode:M,highlightColor:B,shadowColor:D,style:A,highlightOpacity:E,shadowOpacity:x,enabled:m,useGlobalLight:b,direction:L};break;case"sofi":d=i.readUint32(e);var T=i.readUint32(e);if(34!==d)throw new Error("Invalid effects solid fill info size: "+d);if(2!==T)throw new Error("Invalid effects solid fill info version: "+T);y=s(e),w=i.readColor(e),S=u(e),m=!!i.readUint8(e),i.readColor(e),n.solidFill={blendMode:y,color:w,opacity:S,enabled:m};break;default:throw new Error("Invalid effect type: '"+l+"'")}}return n},r.writeEffects=function(e,t){var r,n,i;o.writeUint16(e,0);var s=1;if(t.dropShadow&&s++,t.innerShadow&&s++,t.outerGlow&&s++,t.innerGlow&&s++,t.bevel&&s++,t.solidFill&&s++,o.writeUint16(e,s),o.writeSignature(e,"8BIM"),o.writeSignature(e,"cmnS"),o.writeUint32(e,7),o.writeUint32(e,0),o.writeUint8(e,1),o.writeZeros(e,2),t.dropShadow&&(o.writeSignature(e,"8BIM"),o.writeSignature(e,"dsdw"),c(e,t.dropShadow)),t.innerShadow&&(o.writeSignature(e,"8BIM"),o.writeSignature(e,"isdw"),c(e,t.innerShadow)),t.outerGlow&&(o.writeSignature(e,"8BIM"),o.writeSignature(e,"oglw"),o.writeUint32(e,42),o.writeUint32(e,2),o.writeFixedPoint32(e,(null===(r=t.outerGlow.size)||void 0===r?void 0:r.value)||0),o.writeFixedPoint32(e,0),o.writeColor(e,t.outerGlow.color),l(e,t.outerGlow.blendMode),o.writeUint8(e,t.outerGlow.enabled?1:0),d(e,t.outerGlow.opacity||0),o.writeColor(e,t.outerGlow.color)),t.innerGlow&&(o.writeSignature(e,"8BIM"),o.writeSignature(e,"iglw"),o.writeUint32(e,43),o.writeUint32(e,2),o.writeFixedPoint32(e,(null===(n=t.innerGlow.size)||void 0===n?void 0:n.value)||0),o.writeFixedPoint32(e,0),o.writeColor(e,t.innerGlow.color),l(e,t.innerGlow.blendMode),o.writeUint8(e,t.innerGlow.enabled?1:0),d(e,t.innerGlow.opacity||0),o.writeUint8(e,0),o.writeColor(e,t.innerGlow.color)),t.bevel){o.writeSignature(e,"8BIM"),o.writeSignature(e,"bevl"),o.writeUint32(e,78),o.writeUint32(e,2),o.writeFixedPoint32(e,t.bevel.angle||0),o.writeFixedPoint32(e,t.bevel.strength||0),o.writeFixedPoint32(e,(null===(i=t.bevel.size)||void 0===i?void 0:i.value)||0),l(e,t.bevel.highlightBlendMode),l(e,t.bevel.shadowBlendMode),o.writeColor(e,t.bevel.highlightColor),o.writeColor(e,t.bevel.shadowColor);var u=a.indexOf(t.bevel.style);o.writeUint8(e,u<=0?1:u),d(e,t.bevel.highlightOpacity||0),d(e,t.bevel.shadowOpacity||0),o.writeUint8(e,t.bevel.enabled?1:0),o.writeUint8(e,t.bevel.useGlobalLight?1:0),o.writeUint8(e,"down"===t.bevel.direction?1:0),o.writeColor(e,t.bevel.highlightColor),o.writeColor(e,t.bevel.shadowColor)}t.solidFill&&(o.writeSignature(e,"8BIM"),o.writeSignature(e,"sofi"),o.writeUint32(e,34),o.writeUint32(e,2),l(e,t.solidFill.blendMode),o.writeColor(e,t.solidFill.color),d(e,t.solidFill.opacity||0),o.writeUint8(e,t.solidFill.enabled?1:0),o.writeColor(e,t.solidFill.color))}},{"./helpers":5,"./psdReader":9,"./psdWriter":10}],4:[function(e,t,r){"use strict";function n(e){return 32===e||10===e||13===e||9===e}function i(e){return e>=48&&e<=57||46===e||45===e}Object.defineProperty(r,"__esModule",{value:!0}),r.serializeEngineData=r.parseEngineData=void 0,r.parseEngineData=function(e){var t=0;function r(){for(;t<e.length&&n(e[t]);)t++}function o(){var r=e[t];return t++,92===r&&(r=e[t],t++),r}function a(){var r="";if(41===e[t])return t++,r;if(254!==e[t]||255!==e[t+1])throw new Error("Invalid utf-16 BOM");for(t+=2;t<e.length&&41!==e[t];){var n=o()<<8|o();r+=String.fromCharCode(n)}return t++,r}var s=null,l=[];function u(e){l.length?(d(e),l.push(e)):(l.push(e),s=e)}function d(e){if(!l.length)throw new Error("Invalid data");var t=l[l.length-1];if("string"==typeof t)l[l.length-2][t]=e,f();else{if(!Array.isArray(t))throw new Error("Invalid data");t.push(e)}}function c(e){l.length||u({});var t=l[l.length-1];if(t&&"string"==typeof t)d("nil"===e?null:"/"+e);else{if(!t||"object"!=typeof t)throw new Error("Invalid data");l.push(e)}}function f(){if(!l.length)throw new Error("Invalid data");l.pop()}for(r();t<e.length;){var h=t,p=e[h];if(60===p&&60===e[h+1])t+=2,u({});else if(62===p&&62===e[h+1])t+=2,f();else if(47===p){for(var v=t+=1;t<e.length&&!n(e[t]);)t++;for(var g="",w=v;w<t;w++)g+=String.fromCharCode(e[w]);c(g)}else if(40===p)t+=1,d(a());else if(91===p)t+=1,u([]);else if(93===p)t+=1,f();else if(110===p&&117===e[h+1]&&108===e[h+2]&&108===e[h+3])t+=4,d(null);else if(116===p&&114===e[h+1]&&117===e[h+2]&&101===e[h+3])t+=4,d(!0);else if(102===p&&97===e[h+1]&&108===e[h+2]&&115===e[h+3]&&101===e[h+4])t+=5,d(!1);else if(i(p)){for(var y="";t<e.length&&i(e[t]);)y+=String.fromCharCode(e[t]),t++;d(parseFloat(y))}else t+=1,console.log("Invalid token "+String.fromCharCode(p)+" at "+t);r()}return s};var o=["Axis","XY","Zone","WordSpacing","FirstLineIndent","GlyphSpacing","StartIndent","EndIndent","SpaceBefore","SpaceAfter","LetterSpacing","Values","GridSize","GridLeading","PointBase","BoxBounds","TransformPoint0","TransformPoint1","TransformPoint2","FontSize","Leading","HorizontalScale","VerticalScale","BaselineShift","Tsume","OutlineWidth"],a=["RunLengthArray"];r.serializeEngineData=function(e,t){void 0===t&&(t=!1);var r=new Uint8Array(1024),n=0,i=0;function s(e){if(n>=r.length){var t=new Uint8Array(2*r.length);t.set(r),r=t}r[n]=e,n++}function l(e){for(var t=0;t<e.length;t++)s(e.charCodeAt(t))}function u(){if(t)l(" ");else for(var e=0;e<i;e++)l("\t")}function d(e,r){u(),l("/"+e),v(r,e,!0),t||l("\n")}function c(e){return e.toFixed(5).replace(/(\d)0+$/g,"$1").replace(/^0+\.([1-9])/g,".$1").replace(/^-0+\.0(\d)/g,"-.0$1")}function f(e,t){return t&&-1!==o.indexOf(t)||(0|e)!==e?c(e):function(e){return e.toString()}(e)}function h(e){var t=Object.keys(e);return-1!==t.indexOf("98")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),-1!==t.indexOf("99")&&t.unshift.apply(t,t.splice(t.indexOf("99"),1)),t}function p(e){40!==e&&41!==e&&92!==e||s(92),s(e)}function v(e,r,n){function o(){n?l(" "):u()}if(void 0===n&&(n=!1),null===e)o(),l(t?"/nil":"null");else if("number"==typeof e)o(),l(f(e,r));else if("boolean"==typeof e)o(),l(e?"true":"false");else if("string"==typeof e)if(o(),"99"!==r&&"98"!==r||"/"!==e.charAt(0)){l("("),s(254),s(255);for(var g=0;g<e.length;g++){var w=e.charCodeAt(g);p(w>>8&255),p(255&w)}l(")")}else l(e);else if(Array.isArray(e))if(o(),e.every(function(e){return"number"==typeof e})){l("[");for(var y=-1!==a.indexOf(r),m=0,b=e;m<b.length;m++){var S=b[m];l(" "),l(y?f(S):c(S))}l(" ]")}else{l("["),t||l("\n");for(var k=0,U=e;k<U.length;k++)v(S=U[k],r),t||l("\n");u(),l("]")}else if("object"==typeof e){n&&!t&&l("\n"),u(),l("<<"),t||l("\n"),i++;for(var I=0,C=h(e);I<C.length;I++){var F=C[I];d(F,e[F])}i--,u(),l(">>")}}if(t){if("object"==typeof e)for(var g=0,w=h(e);g<w.length;g++){var y=w[g];d(y,e[y])}}else l("\n\n"),v(e);return r.slice(0,n)}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.initializeCanvas=r.createImageData=r.createCanvasFromData=r.createCanvas=r.writeDataRLE=r.writeDataRaw=r.decodeBitmap=r.resetImageData=r.hasAlpha=r.clamp=r.offsetForChannel=r.Compression=r.ChannelID=r.MaskParams=r.LayerMaskFlags=r.ColorSpace=r.createEnum=r.revMap=r.layerColors=r.toBlendMode=r.fromBlendMode=void 0;var n=e("base64-js");function i(e){var t={};return Object.keys(e).forEach(function(r){return t[e[r]]=r}),t}r.fromBlendMode={},r.toBlendMode={pass:"pass through",norm:"normal",diss:"dissolve",dark:"darken","mul ":"multiply",idiv:"color burn",lbrn:"linear burn",dkCl:"darker color",lite:"lighten",scrn:"screen","div ":"color dodge",lddg:"linear dodge",lgCl:"lighter color",over:"overlay",sLit:"soft light",hLit:"hard light",vLit:"vivid light",lLit:"linear light",pLit:"pin light",hMix:"hard mix",diff:"difference",smud:"exclusion",fsub:"subtract",fdiv:"divide","hue ":"hue","sat ":"saturation",colr:"color","lum ":"luminosity"},Object.keys(r.toBlendMode).forEach(function(e){return r.fromBlendMode[r.toBlendMode[e]]=e}),r.layerColors=["none","red","orange","yellow","green","blue","violet","gray"],r.revMap=i,r.createEnum=function(e,t,r){var n=i(r);return{decode:function(e){return n[e.split(".")[1]]||t},encode:function(n){return e+"."+(r[n]||r[t])}}},function(e){e[e.RGB=0]="RGB",e[e.HSB=1]="HSB",e[e.CMYK=2]="CMYK",e[e.Lab=7]="Lab",e[e.Grayscale=8]="Grayscale"}(r.ColorSpace||(r.ColorSpace={})),function(e){e[e.PositionRelativeToLayer=1]="PositionRelativeToLayer",e[e.LayerMaskDisabled=2]="LayerMaskDisabled",e[e.InvertLayerMaskWhenBlending=4]="InvertLayerMaskWhenBlending",e[e.LayerMaskFromRenderingOtherData=8]="LayerMaskFromRenderingOtherData",e[e.MaskHasParametersAppliedToIt=16]="MaskHasParametersAppliedToIt"}(r.LayerMaskFlags||(r.LayerMaskFlags={})),function(e){e[e.UserMaskDensity=1]="UserMaskDensity",e[e.UserMaskFeather=2]="UserMaskFeather",e[e.VectorMaskDensity=4]="VectorMaskDensity",e[e.VectorMaskFeather=8]="VectorMaskFeather"}(r.MaskParams||(r.MaskParams={})),function(e){e[e.Red=0]="Red",e[e.Green=1]="Green",e[e.Blue=2]="Blue",e[e.Transparency=-1]="Transparency",e[e.UserMask=-2]="UserMask",e[e.RealUserMask=-3]="RealUserMask"}(r.ChannelID||(r.ChannelID={})),function(e){e[e.RawData=0]="RawData",e[e.RleCompressed=1]="RleCompressed",e[e.ZipWithoutPrediction=2]="ZipWithoutPrediction",e[e.ZipWithPrediction=3]="ZipWithPrediction"}(r.Compression||(r.Compression={})),r.offsetForChannel=function(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case-1:return 3;default:return e+1}},r.clamp=function(e,t,r){return e<t?t:e>r?r:e},r.hasAlpha=function(e){for(var t=e.width*e.height*4,r=3;r<t;r+=4)if(255!==e.data[r])return!0;return!1},r.resetImageData=function(e){for(var t=e.width,r=e.height,n=e.data,i=t*r|0,o=new Uint32Array(n.buffer),a=0;a<i;a=a+1|0)o[a]=4278190080},r.decodeBitmap=function(e,t,r,n){for(var i=0,o=0,a=0;i<n;i++)for(var s=0;s<r;)for(var l=e[a++],u=0;u<8&&s<r;u++,s++){var d=128&l?0:255;l<<=1,t[o++]=d,t[o++]=d,t[o++]=d,t[o++]=255}},r.writeDataRaw=function(e,t,r,n){if(r&&n){for(var i=new Uint8Array(r*n),o=0;o<i.length;o++)i[o]=e.data[4*o+t];return i}},r.writeDataRLE=function(e,t,r,n,i){var o=t.data;if(r&&n){for(var a=4*r|0,s=0,l=2*i.length*n|0,u=0,d=i;u<d.length;u++)for(var c=d[u],f=0,h=0|c;f<n;f++){var p=f*a|0,v=p+a|0,g=v+c-4|0,w=g-4|0,y=l;for(h=p+c|0;h<v;h=h+4|0)if(h<w){var m=o[h],b=o[h=h+4|0],S=o[h=h+4|0];if(m===b&&m===S){for(var k=3;k<128&&h<g&&o[h+4|0]===m;)k=k+1|0,h=h+4|0;e[l++]=1-k,e[l++]=m}else{var U=l,I=!0;for(k=1,e[l++]=0,e[l++]=m;h<g&&k<128;){if(m=b,b=S,S=o[h=h+4|0],m===b&&m===S){h=h-12|0,I=!1;break}k++,e[l++]=m}I&&(k<127?(e[l++]=b,e[l++]=S,k+=2):k<128?(e[l++]=b,k++,h=h-4|0):h=h-8|0),e[U]=k-1}}else h===g?(e[l++]=0,e[l++]=o[h]):(e[l++]=1,e[l++]=o[h],h=h+4|0,e[l++]=o[h]);var C=l-y;e[s++]=C>>8&255,e[s++]=255&C}return e.slice(0,l)}},r.createCanvas=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvas method")},r.createCanvasFromData=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvasFromData method")};var o=void 0;r.createImageData=function(e,t){return o||(o=r.createCanvas(1,1)),o.getContext("2d").createImageData(e,t)},"undefined"!=typeof document&&(r.createCanvas=function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r},r.createCanvasFromData=function(e){var t=new Image;t.src="data:image/jpeg;base64,"+n.fromByteArray(e);var r=document.createElement("canvas");return r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0),r}),r.initializeCanvas=function(e,t,n){r.createCanvas=e,r.createCanvasFromData=t||r.createCanvasFromData,r.createImageData=n||r.createImageData}},{"base64-js":13}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.resourceHandlersMap=r.resourceHandlers=void 0;var n=e("base64-js"),i=e("./psdReader"),o=e("./psdWriter"),a=e("./helpers"),s=e("./utf8"),l=e("./descriptor");function u(e,t,n,i){var o={key:e,has:t,read:n,write:i};r.resourceHandlers.push(o),r.resourceHandlersMap[o.key]=o}r.resourceHandlers=[],r.resourceHandlersMap={};var d=[void 0,"PPI","PPCM"],c=[void 0,"Inches","Centimeters","Points","Picas","Columns"],f="0123456789abcdef";function h(e){return e<=57?e-48:e-87}u(1061,function(e){return void 0!==e.captionDigest},function(e,t){for(var r="",n=0;n<16;n++){var o=i.readUint8(e);r+=f[o>>4],r+=f[15&o]}t.captionDigest=r},function(e,t){for(var r=0;r<16;r++)o.writeUint8(e,(n=t.captionDigest,i=2*r,h(n.charCodeAt(i))<<4|h(n.charCodeAt(i+1))));var n,i}),u(1060,function(e){return void 0!==e.xmpMetadata},function(e,t,r){return t.xmpMetadata=function(e,t){var r=i.readBytes(e,t);return s.decodeString(r)}(e,r())},function(e,t){return function(e,t){var r=s.encodeString(t);o.writeBytes(e,r)}(e,t.xmpMetadata)});var p=a.createEnum("Inte","perceptual",{perceptual:"Img ",saturation:"Grp ","relative colorimetric":"Clrm","absolute colorimetric":"AClr"});u(1082,function(e){return void 0!==e.printInformation},function(e,t){var r,n,i=l.readVersionAndDescriptor(e);t.printInformation={printerName:i.printerName||"",renderingIntent:p.decode(null!==(r=i.Inte)&&void 0!==r?r:"Inte.Img ")};var o=t.printInformation;void 0!==i.PstS&&(o.printerManagesColors=i.PstS),void 0!==i["Nm  "]&&(o.printerProfile=i["Nm  "]),void 0!==i.MpBl&&(o.blackPointCompensation=i.MpBl),void 0!==i.printSixteenBit&&(o.printSixteenBit=i.printSixteenBit),void 0!==i.hardProof&&(o.hardProof=i.hardProof),i.printProofSetup&&("Bltn"in i.printProofSetup?o.proofSetup={builtin:i.printProofSetup.Bltn.split(".")[1]}:o.proofSetup={profile:i.printProofSetup.profile,renderingIntent:p.decode(null!==(n=i.printProofSetup.Inte)&&void 0!==n?n:"Inte.Img "),blackPointCompensation:!!i.printProofSetup.MpBl,paperWhite:!!i.printProofSetup.paperWhite})},function(e,t){var r,n,i=t.printInformation,o={};i.printerManagesColors?o.PstS=!0:(void 0!==i.hardProof&&(o.hardProof=!!i.hardProof),o.ClrS="Clrs.RGBC",o["Nm  "]=null!==(r=i.printerProfile)&&void 0!==r?r:"CIE RGB"),o.Inte=p.encode(i.renderingIntent),i.printerManagesColors||(o.MpBl=!!i.blackPointCompensation),o.printSixteenBit=!!i.printSixteenBit,o.printerName=i.printerName||"",i.proofSetup&&"profile"in i.proofSetup?o.printProofSetup={profile:i.proofSetup.profile||"",Inte:p.encode(i.proofSetup.renderingIntent),MpBl:!!i.proofSetup.blackPointCompensation,paperWhite:!!i.proofSetup.paperWhite}:o.printProofSetup={Bltn:(null===(n=i.proofSetup)||void 0===n?void 0:n.builtin)?"builtinProof."+i.proofSetup.builtin:"builtinProof.proofCMYK"},l.writeVersionAndDescriptor(e,"","printOutput",o)}),u(1005,function(e){return void 0!==e.resolutionInfo},function(e,t){var r=i.readFixedPoint32(e),n=i.readUint16(e),o=i.readUint16(e),a=i.readFixedPoint32(e),s=i.readUint16(e),l=i.readUint16(e);t.resolutionInfo={horizontalResolution:r,horizontalResolutionUnit:d[n]||"PPI",widthUnit:c[o]||"Inches",verticalResolution:a,verticalResolutionUnit:d[s]||"PPI",heightUnit:c[l]||"Inches"}},function(e,t){var r=t.resolutionInfo;o.writeFixedPoint32(e,r.horizontalResolution||0),o.writeUint16(e,Math.max(1,d.indexOf(r.horizontalResolutionUnit))),o.writeUint16(e,Math.max(1,c.indexOf(r.widthUnit))),o.writeFixedPoint32(e,r.verticalResolution||0),o.writeUint16(e,Math.max(1,d.indexOf(r.verticalResolutionUnit))),o.writeUint16(e,Math.max(1,c.indexOf(r.heightUnit)))});var v=["centered","size to fit","user defined"];u(1062,function(e){return void 0!==e.printScale},function(e,t){t.printScale={style:v[i.readInt16(e)],x:i.readFloat32(e),y:i.readFloat32(e),scale:i.readFloat32(e)}},function(e,t){var r=t.printScale,n=r.style,i=r.x,a=r.y,s=r.scale;o.writeInt16(e,Math.max(0,v.indexOf(n))),o.writeFloat32(e,i||0),o.writeFloat32(e,a||0),o.writeFloat32(e,s||0)}),u(1006,function(e){return void 0!==e.alphaChannelNames},function(e,t,r){for(t.alphaChannelNames=[];r();){var n=i.readPascalString(e,1);t.alphaChannelNames.push(n)}},function(e,t){for(var r=0,n=t.alphaChannelNames;r<n.length;r++){var i=n[r];o.writePascalString(e,i,1)}}),u(1045,function(e){return void 0!==e.alphaChannelNames},function(e,t,r){for(t.alphaChannelNames=[];r();)t.alphaChannelNames.push(i.readUnicodeString(e))},function(e,t){for(var r=0,n=t.alphaChannelNames;r<n.length;r++){var i=n[r];o.writeUnicodeStringWithPadding(e,i)}}),u(1053,function(e){return void 0!==e.alphaIdentifiers},function(e,t,r){for(t.alphaIdentifiers=[];r()>=4;)t.alphaIdentifiers.push(i.readUint32(e))},function(e,t){for(var r=0,n=t.alphaIdentifiers;r<n.length;r++){var i=n[r];o.writeUint32(e,i)}}),u(1010,function(e){return void 0!==e.backgroundColor},function(e,t){return t.backgroundColor=i.readColor(e)},function(e,t){return o.writeColor(e,t.backgroundColor)}),u(1037,function(e){return void 0!==e.globalAngle},function(e,t){return t.globalAngle=i.readUint32(e)},function(e,t){return o.writeUint32(e,t.globalAngle)}),u(1049,function(e){return void 0!==e.globalAltitude},function(e,t){return t.globalAltitude=i.readUint32(e)},function(e,t){return o.writeUint32(e,t.globalAltitude)}),u(1011,function(e){return void 0!==e.printFlags},function(e,t){t.printFlags={labels:!!i.readUint8(e),cropMarks:!!i.readUint8(e),colorBars:!!i.readUint8(e),registrationMarks:!!i.readUint8(e),negative:!!i.readUint8(e),flip:!!i.readUint8(e),interpolate:!!i.readUint8(e),caption:!!i.readUint8(e),printFlags:!!i.readUint8(e)}},function(e,t){var r=t.printFlags;o.writeUint8(e,r.labels?1:0),o.writeUint8(e,r.cropMarks?1:0),o.writeUint8(e,r.colorBars?1:0),o.writeUint8(e,r.registrationMarks?1:0),o.writeUint8(e,r.negative?1:0),o.writeUint8(e,r.flip?1:0),o.writeUint8(e,r.interpolate?1:0),o.writeUint8(e,r.caption?1:0),o.writeUint8(e,r.printFlags?1:0)}),u(1024,function(e){return void 0!==e.layerState},function(e,t){return t.layerState=i.readUint16(e)},function(e,t){return o.writeUint16(e,t.layerState)}),u(1026,function(e){return void 0!==e.layersGroup},function(e,t,r){for(t.layersGroup=[];r();)t.layersGroup.push(i.readUint16(e))},function(e,t){for(var r=0,n=t.layersGroup;r<n.length;r++){var i=n[r];o.writeUint16(e,i)}}),u(1072,function(e){return void 0!==e.layerGroupsEnabledId},function(e,t,r){for(t.layerGroupsEnabledId=[];r();)t.layerGroupsEnabledId.push(i.readUint8(e))},function(e,t){for(var r=0,n=t.layerGroupsEnabledId;r<n.length;r++){var i=n[r];o.writeUint8(e,i)}}),u(1069,function(e){return void 0!==e.layerSelectionIds},function(e,t){var r=i.readUint16(e);for(t.layerSelectionIds=[];r--;)t.layerSelectionIds.push(i.readUint32(e))},function(e,t){o.writeUint16(e,t.layerSelectionIds.length);for(var r=0,n=t.layerSelectionIds;r<n.length;r++){var i=n[r];o.writeUint32(e,i)}}),u(1032,function(e){return void 0!==e.gridAndGuidesInformation},function(e,t){var r=i.readUint32(e),n=i.readUint32(e),o=i.readUint32(e),a=i.readUint32(e);if(1!==r)throw new Error("Invalid 1032 resource version: "+r);t.gridAndGuidesInformation={grid:{horizontal:n,vertical:o},guides:[]};for(var s=0;s<a;s++)t.gridAndGuidesInformation.guides.push({location:i.readUint32(e)/32,direction:i.readUint8(e)?"horizontal":"vertical"})},function(e,t){var r=t.gridAndGuidesInformation,n=r.grid||{horizontal:576,vertical:576},i=r.guides||[];o.writeUint32(e,1),o.writeUint32(e,n.horizontal),o.writeUint32(e,n.vertical),o.writeUint32(e,i.length);for(var a=0,s=i;a<s.length;a++){var l=s[a];o.writeUint32(e,32*l.location),o.writeUint8(e,"horizontal"===l.direction?1:0)}}),u(1054,function(e){return void 0!==e.urlsList},function(e,t,r,n){if(i.readUint32(e)){if(!n.throwForMissingFeatures)return;throw new Error("Not implemented: URL List")}t.urlsList=[]},function(e,t){if(o.writeUint32(e,t.urlsList.length),t.urlsList.length)throw new Error("Not implemented: URL List")}),u(1064,function(e){return void 0!==e.pixelAspectRatio},function(e,t){if(i.readUint32(e)>2)throw new Error("Invalid pixelAspectRatio version");t.pixelAspectRatio={aspect:i.readFloat64(e)}},function(e,t){o.writeUint32(e,2),o.writeFloat64(e,t.pixelAspectRatio.aspect)}),u(1044,function(e){return void 0!==e.idsSeedNumber},function(e,t){return t.idsSeedNumber=i.readUint32(e)},function(e,t){return o.writeUint32(e,t.idsSeedNumber)}),u(1036,function(e){return void 0!==e.thumbnail||void 0!==e.thumbnailRaw},function(e,t,r,n){var o=i.readUint32(e),s=i.readUint32(e),l=i.readUint32(e);i.readUint32(e),i.readUint32(e),i.readUint32(e);var u=i.readUint16(e),d=i.readUint16(e);if(1!==o||24!==u||1!==d)return n.logMissingFeatures&&console.log("Invalid thumbnail data (format: "+o+", bitsPerPixel: "+u+", planes: "+d+")"),void i.skipBytes(e,r());var c=r(),f=i.readBytes(e,c);n.useRawThumbnail?t.thumbnailRaw={width:s,height:l,data:f}:t.thumbnail=a.createCanvasFromData(f)},function(e,t){var r,i=0,a=0;t.thumbnailRaw?(i=t.thumbnailRaw.width,a=t.thumbnailRaw.height,r=t.thumbnailRaw.data):(i=t.thumbnail.width,a=t.thumbnail.height,r=n.toByteArray(t.thumbnail.toDataURL("image/jpeg",1).substr("data:image/jpeg;base64,".length)));var s=4*Math.floor((24*i+31)/32),l=s*a*1,u=r.length;o.writeUint32(e,1),o.writeUint32(e,i),o.writeUint32(e,a),o.writeUint32(e,s),o.writeUint32(e,l),o.writeUint32(e,u),o.writeUint16(e,24),o.writeUint16(e,1),o.writeBytes(e,r)}),u(1057,function(e){return void 0!==e.versionInfo},function(e,t,r){if(1!==i.readUint32(e))throw new Error("Invalid versionInfo version");t.versionInfo={hasRealMergedData:!!i.readUint8(e),writerName:i.readUnicodeString(e),readerName:i.readUnicodeString(e),fileVersion:i.readUint32(e)},i.skipBytes(e,r())},function(e,t){var r=t.versionInfo;o.writeUint32(e,1),o.writeUint8(e,r.hasRealMergedData?1:0),o.writeUnicodeString(e,r.writerName),o.writeUnicodeString(e,r.readerName),o.writeUint32(e,r.fileVersion)});a.createEnum("FrmD","",{auto:"Auto",none:"None",dispose:"Disp"})},{"./descriptor":2,"./helpers":5,"./psdReader":9,"./psdWriter":10,"./utf8":12,"base64-js":13}],7:[function(e,t,r){(function(t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.writePsdBuffer=r.writePsdUint8Array=r.writePsd=r.readPsd=r.byteArrayToBase64=void 0;var o=e("./psdWriter"),a=e("./psdReader"),s=e("./helpers");Object.defineProperty(r,"initializeCanvas",{enumerable:!0,get:function(){return s.initializeCanvas}}),i(e("./psd"),r);var l=e("base64-js");function u(e,t){var r=o.createWriter();return o.writePsd(r,e,t),o.getWriterBufferNoCopy(r)}r.byteArrayToBase64=l.fromByteArray,r.readPsd=function(e,t){var r="buffer"in e?a.createReader(e.buffer,e.byteOffset,e.byteLength):a.createReader(e);return a.readPsd(r,t)},r.writePsd=function(e,t){var r=o.createWriter();return o.writePsd(r,e,t),o.getWriterBuffer(r)},r.writePsdUint8Array=u,r.writePsdBuffer=function(e,r){if(void 0===t)throw new Error("Buffer not supported on this platform");return t.from(u(e,r))}}).call(this,e("buffer").Buffer)},{"./helpers":5,"./psd":8,"./psdReader":9,"./psdWriter":10,"base64-js":13,buffer:14}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SectionDividerType=r.ColorMode=void 0,function(e){e[e.Bitmap=0]="Bitmap",e[e.Grayscale=1]="Grayscale",e[e.Indexed=2]="Indexed",e[e.RGB=3]="RGB",e[e.CMYK=4]="CMYK",e[e.Multichannel=7]="Multichannel",e[e.Duotone=8]="Duotone",e[e.Lab=9]="Lab"}(r.ColorMode||(r.ColorMode={})),function(e){e[e.Other=0]="Other",e[e.OpenFolder=1]="OpenFolder",e[e.ClosedFolder=2]="ClosedFolder",e[e.BoundingSectionDivider=3]="BoundingSectionDivider"}(r.SectionDividerType||(r.SectionDividerType={}))},{}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.readColor=r.readSection=r.readDataRLE=r.readPsd=r.checkSignature=r.skipBytes=r.readAsciiString=r.readUnicodeStringWithLength=r.readUnicodeString=r.readPascalString=r.readSignature=r.readBytes=r.readFixedPointPath32=r.readFixedPoint32=r.readFloat64=r.readFloat32=r.readUint32=r.readInt32LE=r.readInt32=r.readUint16=r.readInt16=r.peekUint8=r.readUint8=r.createReader=r.supportedColorModes=void 0;var n=e("./helpers"),i=e("./additionalInfo"),o=e("./imageResources");r.supportedColorModes=[0,1,3];var a=["bitmap","grayscale","indexed","RGB","CMYK","multichannel","duotone","lab"],s=!1;function l(e){for(var t=e.width*e.height*4,r=0;r<t;r+=4)e.data[r+1]=e.data[r],e.data[r+2]=e.data[r]}function u(e){return e.offset+=1,e.view.getUint8(e.offset-1)}function d(e){return e.view.getUint8(e.offset)}function c(e){return e.offset+=2,e.view.getInt16(e.offset-2,!1)}function f(e){return e.offset+=2,e.view.getUint16(e.offset-2,!1)}function h(e){return e.offset+=4,e.view.getInt32(e.offset-4,!1)}function p(e){return e.offset+=4,e.view.getUint32(e.offset-4,!1)}function v(e){return e.offset+=8,e.view.getFloat64(e.offset-8,!1)}function g(e,t){return e.offset+=t,new Uint8Array(e.view.buffer,e.view.byteOffset+e.offset-t,t)}function w(e){return k(e,4)}function y(e,t){void 0===t&&(t=2);for(var r=u(e),n=k(e,r);++r%t;)b(e,1);return n}function m(e,t){for(var r="";t--;){var n=f(e);(n||t>0)&&(r+=String.fromCharCode(n))}return r}function b(e,t){e.offset+=t}function S(e,t,r){var n=e.offset,i=w(e);if(i!==t&&i!==r)throw new Error("Invalid signature: '"+i+"' at 0x"+n.toString(16))}function k(e,t){var r=g(e,t);return String.fromCharCode.apply(String,r)}function U(e,t,r){var i={};i.top=h(e),i.left=h(e),i.bottom=h(e),i.right=h(e);for(var o=f(e),a=[],s=0;s<o;s++){var l=c(e),d=h(e);a.push({id:l,length:d})}S(e,"8BIM");var g=w(e);if(!n.toBlendMode[g])throw new Error("Invalid blend mode: '"+g+"'");i.blendMode=n.toBlendMode[g],i.opacity=u(e)/255,i.clipping=1===u(e);var m=u(e);return i.transparencyProtected=0!=(1&m),i.hidden=0!=(2&m),b(e,1),B(e,1,function(n){var o=function(e,t){return B(e,1,function(r){if(r()){var n={};n.top=h(e),n.left=h(e),n.bottom=h(e),n.right=h(e),n.defaultColor=u(e);var i=u(e);if(n.positionRelativeToLayer=0!=(1&i),n.disabled=0!=(2&i),16&i){var o=u(e);1&o&&(n.userMaskDensity=u(e)/255),2&o&&(n.userMaskFeather=v(e)),4&o&&(n.vectorMaskDensity=u(e)/255),8&o&&(n.vectorMaskFeather=v(e))}return r()>2&&(t.logMissingFeatures&&console.log("Unhandled extra mask params"),u(e),u(e),h(e),h(e),h(e),h(e)),b(e,r()),n}})}(e,r);for(o&&(i.mask=o),function(e){B(e,1,function(t){for(var r=p(e),n=p(e),i=[];t();){var o=p(e),a=p(e);i.push({sourceRange:o,destRange:a})}return{compositeGrayBlendSource:r,compositeGraphBlendDestinationRange:n,ranges:i}})}(e),i.name=y(e,4);n();)F(e,i,t,r)}),{layer:i,channels:a}}function I(e,t,r,i,o){var a,u=(r.right||0)-(r.left||0),d=(r.bottom||0)-(r.top||0);u&&d&&(a=n.createImageData(u,d),n.resetImageData(a)),s&&(r.imageDataRaw=[]);for(var c=0,h=i;c<h.length;c++){var p=h[c],v=f(e);if(-2===p.id){var g=r.mask;if(!g)throw new Error("Missing layer mask data");var w=(g.right||0)-(g.left||0),y=(g.bottom||0)-(g.top||0);if(w&&y){var m=n.createImageData(w,y);n.resetImageData(m),C(e,m,v,w,y,0),l(m),o.useImageData?g.imageData=m:(g.canvas=n.createCanvas(w,y),g.canvas.getContext("2d").putImageData(m,0,0))}}else{var b=n.offsetForChannel(p.id),S=a;if(b<0&&(S=void 0,o.throwForMissingFeatures))throw new Error("Channel not supported: "+p.id);var k=e.offset;C(e,S,v,u,d,b),s&&(r.imageDataRaw[p.id]=new Uint8Array(e.view.buffer,e.view.byteOffset+k,e.offset-k)),S&&1===t.colorMode&&l(S)}}a&&(o.useImageData?r.imageData=a:(r.canvas=n.createCanvas(u,d),r.canvas.getContext("2d").putImageData(a,0,0)))}function C(e,t,r,n,i,o){if(0===r)P(e,t,o,n,i);else{if(1!==r)throw new Error("Compression type not supported: "+r);M(e,t,n,i,4,[o])}}function F(e,t,r,n){S(e,"8BIM","8B64");var o=w(e);B(e,2,function(a){var s=i.infoHandlersMap[o];if(s)try{s.read(e,t,a,r,n)}catch(e){if(n.throwForMissingFeatures)throw e}else n.logMissingFeatures&&console.log("Unhandled additional info: "+o),b(e,a());a()&&(n.logMissingFeatures&&console.log("Unread "+a()+" bytes left for tag: "+o),b(e,a()))},!1)}function P(e,t,r,n,i){var o=n*i,a=g(e,o);if(t&&r<4)for(var s=t.data,l=0,u=0|r;l<o;l++,u=u+4|0)s[u]=a[l]}function M(e,t,r,n,i,o){for(var a=new Uint16Array(o.length*n),s=t&&t.data,l=0,u=0;l<o.length;l++)for(var d=0;d<n;d++,u++)a[u]=f(e);var c=0;for(u=0;c<o.length;c++){var h=0|o[c];if(!s||(c>3||h>3))for(d=0;d<n;d++,u++)b(e,a[u]);else{d=0;for(var p=0|h;d<n;d++,u++)for(var v=a[u],w=g(e,v),y=0;y<v;y++){var m=w[y];if(m>128){var S=w[++y];m=256-m|0;for(var k=0;k<=m;k=k+1|0)s[p]=S,p=p+i|0}else if(m<128)for(k=0;k<=m;k=k+1|0)s[p]=w[++y],p=p+i|0;if(y>=v)throw new Error("Invalid RLE data: exceeded buffer size "+y+"/"+v)}}}}function B(e,t,r,n){void 0===n&&(n=!0);var i=h(e);if(!(i<=0&&n)){var o=e.offset+i,a=r(function(){return o-e.offset});if(e.offset>o)throw new Error("Exceeded section limits");if(e.offset!==o)throw new Error("Unread section data: "+(o-e.offset)+" bytes at 0x"+e.offset.toString(16));for(;o%t;)o++;return e.offset=o,a}}r.createReader=function(e,t,r){return{view:new DataView(e,t,r),offset:0}},r.readUint8=u,r.peekUint8=d,r.readInt16=c,r.readUint16=f,r.readInt32=h,r.readInt32LE=function(e){return e.offset+=4,e.view.getInt32(e.offset-4,!0)},r.readUint32=p,r.readFloat32=function(e){return e.offset+=4,e.view.getFloat32(e.offset-4,!1)},r.readFloat64=v,r.readFixedPoint32=function(e){return h(e)/65536},r.readFixedPointPath32=function(e){return h(e)/(1<<24)},r.readBytes=g,r.readSignature=w,r.readPascalString=y,r.readUnicodeString=function(e){return m(e,p(e))},r.readUnicodeStringWithLength=m,r.readAsciiString=function(e,t){for(var r="";t--;)r+=String.fromCharCode(u(e));return r},r.skipBytes=b,r.checkSignature=S,r.readPsd=function(e,t){var i;void 0===t&&(t={}),S(e,"8BPS");var h=f(e);if(1!==h)throw new Error("Invalid PSD file version: "+h);b(e,6);var v=f(e),w=p(e),m=p(e),k=f(e),C=f(e);if(-1===r.supportedColorModes.indexOf(C))throw new Error("Color mode not supported: "+(null!==(i=a[C])&&void 0!==i?i:C));var D={width:m,height:w,channels:v,bitsPerChannel:k,colorMode:C};B(e,1,function(r){if(t.throwForMissingFeatures)throw new Error("Color mode data not supported");b(e,r())}),B(e,1,function(r){for(var n=function(){S(e,"8BIM");var r=f(e);y(e),B(e,2,function(n){var i=o.resourceHandlersMap[r],a=1036===r&&!!t.skipThumbnail;if(D.imageResources||(D.imageResources={}),i&&!a)try{i.read(e,D.imageResources,n,t)}catch(r){if(t.throwForMissingFeatures)throw r;b(e,n())}else b(e,n())})};r();)n()});var A=!1;B(e,1,function(r){for(A=function(e,t,r){var n=!1;return B(e,2,function(i){var o=c(e);o<0&&(n=!0,o=-o);for(var a=[],s=[],l=0;l<o;l++){var u=U(e,t,r),d=u.layer,f=u.channels;a.push(d),s.push(f)}if(!r.skipLayerImageData)for(l=0;l<o;l++)I(e,t,a[l],s[l],r);b(e,i()),t.children||(t.children=[]);var h=[t];for(l=a.length-1;l>=0;l--){var p=a[l],v=p.sectionDivider?p.sectionDivider.type:0;1===v||2===v?(p.opened=1===v,p.children=[],h[h.length-1].children.unshift(p),h.push(p)):3===v?h.pop():h[h.length-1].children.unshift(p)}}),n}(e,D,t),r()>0?function(e){B(e,1,function(t){if(t()){var r=f(e),n=f(e),i=f(e),o=f(e),a=f(e),s=f(e)/255,l=u(e);return b(e,t()),{overlayColorSpace:r,colorSpace1:n,colorSpace2:i,colorSpace3:o,colorSpace4:a,opacity:s,kind:l}}})}(e):b(e,r());r()>0;){for(;r()&&0===d(e);)b(e,1);r()>=12?F(e,D,D,t):b(e,r())}});var E=D.children&&D.children.length;return t.skipCompositeImageData&&(t.skipLayerImageData||E)||function(e,t,i,o){var a=f(e);if(-1===r.supportedColorModes.indexOf(t.colorMode))throw new Error("Color mode not supported: "+t.colorMode);if(0!==a&&1!==a)throw new Error("Compression type not supported: "+a);var u=n.createImageData(t.width,t.height);if(n.resetImageData(u),0===t.colorMode){var d=void 0;if(0===a)d=g(e,Math.ceil(t.width/8)*t.height);else{if(1!==a)throw new Error("Bitmap compression not supported: "+a);d=new Uint8Array(t.width*t.height),M(e,{data:d,width:t.width,height:t.height},t.width,t.height,1,[0])}n.decodeBitmap(d,u.data,t.width,t.height)}else{var c=1===t.colorMode?[0]:[0,1,2];if(t.channels&&t.channels>3)for(var h=3;h<t.channels;h++)c.push(h);else i&&c.push(3);if(0===a)for(var h=0;h<c.length;h++)P(e,u,c[h],t.width,t.height);else if(1===a){var p=e.offset;M(e,u,t.width,t.height,4,c),s&&(t.imageDataRaw=new Uint8Array(e.view.buffer,e.view.byteOffset+p,e.offset-p))}1===t.colorMode&&l(u)}o.useImageData?t.imageData=u:(t.canvas=n.createCanvas(t.width,t.height),t.canvas.getContext("2d").putImageData(u,0,0))}(e,D,A,t),D},r.readDataRLE=M,r.readSection=B,r.readColor=function(e){switch(f(e)){case 0:var t=f(e)/257,r=f(e)/257,n=f(e)/257;return b(e,2),{r:t,g:r,b:n};case 7:var i=c(e)/100,o=c(e)/100;return n=c(e)/100,b(e,2),{l:i,a:o,b:n};case 2:return{c:c(e),m:c(e),y:c(e),k:a=c(e)};case 8:var a=c(e);return b(e,6),{k:a};case 1:var s=c(e),l=c(e);return n=c(e),b(e,2),{h:s,s:l,b:n};default:throw new Error("Invalid color space")}}},{"./additionalInfo":1,"./helpers":5,"./imageResources":6}],10:[function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.writeColor=r.writePsd=r.writeSection=r.writeUnicodeStringWithPadding=r.writeUnicodeString=r.writePascalString=r.writeSignature=r.writeZeros=r.writeBytes=r.writeFixedPointPath32=r.writeFixedPoint32=r.writeFloat64=r.writeFloat32=r.writeUint32=r.writeInt32=r.writeUint16=r.writeInt16=r.writeUint8=r.getWriterBufferNoCopy=r.getWriterBuffer=r.createWriter=void 0;var i=e("./helpers"),o=e("./additionalInfo"),a=e("./imageResources"),s=!1;function l(e,t){var r=S(e,1);e.view.setUint8(r,t)}function u(e,t){var r=S(e,2);e.view.setInt16(r,t,!1)}function d(e,t){var r=S(e,2);e.view.setUint16(r,t,!1)}function c(e,t){var r=S(e,4);e.view.setInt32(r,t,!1)}function f(e,t){var r=S(e,4);e.view.setUint32(r,t,!1)}function h(e,t){var r=S(e,8);e.view.setFloat64(r,t,!1)}function p(e,t){t&&(b(e,e.offset+t.length),new Uint8Array(e.buffer).set(t,e.offset),e.offset+=t.length)}function v(e,t){for(var r=0;r<t;r++)l(e,0)}function g(e,t){if(4!==t.length)throw new Error("Invalid signature: '"+t+"'");for(var r=0;r<4;r++)l(e,t.charCodeAt(r))}function w(e,t,r){void 0===r&&(r=2);var n=t.length;l(e,n);for(var i=0;i<n;i++){var o=t.charCodeAt(i);l(e,o<128?o:"?".charCodeAt(0))}for(;++n%r;)l(e,0)}function y(e,t,r,n){void 0===n&&(n=!1);var i=e.offset;c(e,0),r();for(var o=e.offset-i-4,a=o;a%t!=0;)l(e,0),a++;n&&(o=a),e.view.setInt32(i,o,!1)}function m(e,t,r,n){for(var i=function(i){if("Txt2"===i.key&&n.invalidateTextLayers)return"continue";if(i.has(t)){g(e,"8BIM"),g(e,i.key);var o="Txt2"===i.key?4:2;y(e,o,function(){return i.write(e,t,r,n)},"Txt2"!==i.key)}},a=0,s=o.infoHandlers;a<s.length;a++){i(s[a])}}function b(e,t){t>e.buffer.byteLength&&function(e,t){var r=e.buffer.byteLength;do{r*=2}while(t>r);var n=new ArrayBuffer(r),i=new Uint8Array(n),o=new Uint8Array(e.buffer);i.set(o),e.buffer=n,e.view=new DataView(e.buffer)}(e,t)}function S(e,t){var r=e.offset;return b(e,e.offset+=t),r}function k(e){var t=e.canvas;return e.imageData||t||{width:0,height:0}}function U(e,t,r,n){for(var i=e.data,o=4*(t*e.width+r)+3|0,a=o+4*(n-r)|0,s=o;s<a;s=s+4|0)if(0!==i[s])return!1;return!0}function I(e,t,r,n){for(var i=e.data,o=4*e.width|0,a=r,s=r*o+4*t+3|0;a<n;a++,s=s+o|0)if(0!==i[s])return!1;return!0}r.createWriter=function(e){void 0===e&&(e=4096);var t=new ArrayBuffer(e);return{buffer:t,view:new DataView(t),offset:0}},r.getWriterBuffer=function(e){return e.buffer.slice(0,e.offset)},r.getWriterBufferNoCopy=function(e){return new Uint8Array(e.buffer,0,e.offset)},r.writeUint8=l,r.writeInt16=u,r.writeUint16=d,r.writeInt32=c,r.writeUint32=f,r.writeFloat32=function(e,t){var r=S(e,4);e.view.setFloat32(r,t,!1)},r.writeFloat64=h,r.writeFixedPoint32=function(e,t){c(e,65536*t)},r.writeFixedPointPath32=function(e,t){c(e,t*(1<<24))},r.writeBytes=p,r.writeZeros=v,r.writeSignature=g,r.writePascalString=w,r.writeUnicodeString=function(e,t){f(e,t.length);for(var r=0;r<t.length;r++)d(e,t.charCodeAt(r))},r.writeUnicodeStringWithPadding=function(e,t){f(e,t.length+1);for(var r=0;r<t.length;r++)d(e,t.charCodeAt(r));d(e,0)},r.writeSection=y,r.writePsd=function(e,t,r){if(void 0===r&&(r={}),!(+t.width>0&&+t.height>0))throw new Error("Invalid document size");var o=t.imageResources||{};r.generateThumbnail&&(o=n(n({},o),{thumbnail:function(e){var t=i.createCanvas(10,10),r=1;e.width>e.height?(t.width=160,t.height=Math.floor(e.height*(t.width/e.width)),r=t.width/e.width):(t.height=160,t.width=Math.floor(e.width*(t.height/e.height)),r=t.height/e.height);var n=t.getContext("2d");if(n.scale(r,r),e.imageData){var o=i.createCanvas(e.imageData.width,e.imageData.height);o.getContext("2d").putImageData(e.imageData,0,0),n.drawImage(o,0,0)}else e.canvas&&n.drawImage(e.canvas,0,0);return t}(t)}));var b=t.imageData;if(!b&&t.canvas&&(b=t.canvas.getContext("2d").getImageData(0,0,t.canvas.width,t.canvas.height)),b&&(t.width!==b.width||t.height!==b.height))throw new Error("Document canvas must have the same size as document");var S=!!b&&i.hasAlpha(b),C=Math.max(function e(t){void 0===t&&(t=[]);for(var r=0,n=0,i=t;n<i.length;n++){var o=i[n];if(o.canvas||o.imageData){var a=k(o),s=a.width,l=a.height;r=Math.max(r,2*l+2*s*l)}o.children&&(r=Math.max(r,e(o.children)))}return r}(t.children),8*t.width*t.height+2*t.height),F=new Uint8Array(C);g(e,"8BPS"),d(e,1),v(e,6),d(e,S?4:3),f(e,t.height),f(e,t.width),d(e,8),d(e,3),y(e,1,function(){}),y(e,1,function(){for(var t=function(t){t.has(o)&&(g(e,"8BIM"),d(e,t.key),w(e,""),y(e,2,function(){return t.write(e,o)}))},r=0,n=a.resourceHandlers;r<n.length;r++)t(n[r])}),y(e,2,function(){!function(e,t,r,o,a){y(t,4,function(){var b,S=[];!function e(t,r){if(r)for(var i=0,o=r;i<o.length;i++){var a=o[i];if(a.children&&a.canvas)throw new Error("Invalid layer, cannot have both 'canvas' and 'children' properties");if(a.children&&a.imageData)throw new Error("Invalid layer, cannot have both 'imageData' and 'children' properties");if(a.children){var s={type:!1===a.opened?2:1,key:"pass",subtype:0};t.push({name:"</Layer group>",sectionDivider:{type:3}}),e(t,a.children),t.push(n(n({},a),{sectionDivider:s}))}else t.push(n({},a))}}(S,r.children),S.length||S.push({}),u(t,o?-S.length:S.length);for(var C=S.map(function(t,r){return function(e,t,r,n){var o=function(e,t,r,n){var o=t.top,a=void 0===o?0:o,l=t.left,u=void 0===l?0:l,d=t.right,c=void 0===d?0:d,f=t.bottom,h=void 0===f?0:f,p=[{channelId:-1,compression:0,buffer:void 0,length:2}],v=k(t),g=v.width,w=v.height;if(!t.canvas&&!t.imageData||!g||!w)return{layer:t,top:a,left:u,right:c=u,bottom:h=a,channels:p};c=u+g,h=a+w;var y=t.imageData||t.canvas.getContext("2d").getImageData(0,0,g,w);if(n.trimImageData){var m=function(e){for(var t=0,r=0,n=e.width,i=e.height;t<i&&U(e,t,r,n);)t++;for(;i>t&&U(e,i-1,r,n);)i--;for(;r<n&&I(e,r,t,i);)r++;for(;n>r&&I(e,n-1,t,i);)n--;return{top:t,left:r,right:n,bottom:i}}(y);if(0!==m.left||0!==m.top||m.right!==y.width||m.bottom!==y.height){if(u+=m.left,a+=m.top,c-=y.width-m.right,h-=y.height-m.bottom,w=h-a,!(g=c-u)||!w)return{layer:t,top:a,left:u,right:c,bottom:h,channels:p};y=t.imageData?function(e,t,r,n,o){for(var a=i.createImageData(n,o),s=e.data,l=a.data,u=0;u<o;u++)for(var d=0;d<n;d++){var c=4*(d+t+(u+r)*n),f=4*(d+u*n);l[f]=s[c],l[f+1]=s[c+1],l[f+2]=s[c+2],l[f+3]=s[c+3]}return a}(y,m.left,m.top,g,w):t.canvas.getContext("2d").getImageData(m.left,m.top,g,w)}}var b=[0,1,2];return(!r||i.hasAlpha(y)||t.mask)&&b.unshift(-1),p=b.map(function(r){var n=i.offsetForChannel(r),o=i.writeDataRLE(e,y,g,w,[n]);return s&&t.imageDataRaw&&(console.log("written raw layer image data"),o=t.imageDataRaw[r]),{channelId:r,compression:1,buffer:o,length:2+o.length}}),{layer:t,top:a,left:u,right:c,bottom:h,channels:p}}(e,t,r,n),a=t.mask;if(a){var l=a.top,u=void 0===l?0:l,d=a.left,c=void 0===d?0:d,f=a.right,h=void 0===f?0:f,p=a.bottom,v=void 0===p?0:p,g=k(a),w=g.width,y=g.height,m=a.imageData;if(!m&&a.canvas&&w&&y&&(m=a.canvas.getContext("2d").getImageData(0,0,w,y)),w&&y&&m){h=c+w,v=u+y;var b=i.writeDataRLE(e,m,w,y,[0]);o.mask={top:u,left:c,right:h,bottom:v},o.channels.push({channelId:-2,compression:1,buffer:b,length:2+b.length})}else o.mask={top:0,left:0,right:0,bottom:0},o.channels.push({channelId:-2,compression:0,buffer:new Uint8Array(0),length:0})}return o}(e,t,0===r,a)}),F=function(e){var n=e.layer,o=e.top,s=e.left,p=e.bottom,S=e.right,k=e.channels;c(t,o),c(t,s),c(t,p),c(t,S),d(t,k.length);for(var U=0,I=k;U<I.length;U++){var C=I[U];u(t,C.channelId),c(t,C.length)}g(t,"8BIM"),g(t,i.fromBlendMode[n.blendMode]||"norm"),l(t,Math.round(255*i.clamp(null!==(b=n.opacity)&&void 0!==b?b:1,0,1))),l(t,n.clipping?1:0);var F=8;n.transparencyProtected&&(F|=1),n.hidden&&(F|=2),n.vectorMask&&(F|=16),l(t,F),l(t,0),y(t,1,function(){!function(e,t,r){var n=t.mask,i=t.vectorMask;y(e,1,function(){if(n){var t=r.mask||{};c(e,t.top),c(e,t.left),c(e,t.bottom),c(e,t.right),l(e,n.defaultColor);var o=0;void 0!==n.userMaskDensity&&(o|=1),void 0!==n.userMaskFeather&&(o|=2),void 0!==n.vectorMaskDensity&&(o|=4),void 0!==n.vectorMaskFeather&&(o|=8);var a=0;n.disabled&&(a|=2),n.positionRelativeToLayer&&(a|=1),i&&(a|=8),o&&(a|=16),l(e,a),o&&(l(e,o),void 0!==n.userMaskDensity&&l(e,Math.round(255*n.userMaskDensity)),void 0!==n.userMaskFeather&&h(e,n.userMaskFeather),void 0!==n.vectorMaskDensity&&l(e,Math.round(255*n.vectorMaskDensity)),void 0!==n.vectorMaskFeather&&h(e,n.vectorMaskFeather)),v(e,2)}})}(t,n,e),function(e,t){y(e,1,function(){f(e,65535),f(e,65535);for(var r=t.channels||0,n=0;n<r;n++)f(e,65535),f(e,65535)})}(t,r),w(t,n.name||"",4),m(t,n,r,a)})},P=0,M=C;P<M.length;P++){var B=M[P];F(B)}for(var D=0,A=C;D<A.length;D++)for(var B=A[D],E=0,x=B.channels;E<x.length;E++){var L=x[E];d(t,L.compression),L.buffer&&p(t,L.buffer)}},!0)}(F,e,t,S,r),function(e){y(e,1,function(){})}(e),m(e,t,t,r)});var P=S?[0,1,2,3]:[0,1,2],M=b||{data:new Uint8Array(4*t.width*t.height),width:t.width,height:t.height};d(e,1),s&&t.imageDataRaw?(console.log("writing raw image data"),p(e,t.imageDataRaw)):p(e,i.writeDataRLE(F,M,t.width,t.height,P))},r.writeColor=function(e,t){t?"r"in t?(d(e,0),d(e,Math.round(257*t.r)),d(e,Math.round(257*t.g)),d(e,Math.round(257*t.b)),d(e,0)):"l"in t?(d(e,7),d(e,Math.round(100*t.l)),d(e,Math.round(100*t.a)),d(e,Math.round(100*t.b)),d(e,0)):"h"in t?(d(e,1),d(e,Math.round(t.h)),d(e,Math.round(t.s)),d(e,Math.round(t.b)),d(e,0)):"c"in t?(d(e,2),d(e,Math.round(t.c)),d(e,Math.round(t.m)),d(e,Math.round(t.y)),d(e,Math.round(t.k))):(d(e,8),d(e,Math.round(t.k)),v(e,6)):(d(e,0),v(e,8))}},{"./additionalInfo":1,"./helpers":5,"./imageResources":6}],11:[function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.encodeEngineData=r.decodeEngineData=void 0;var i={name:"MyriadPro-Regular",script:0,type:0,synthetic:0},o={justification:"left",firstLineIndent:0,startIndent:0,endIndent:0,spaceBefore:0,spaceAfter:0,autoHyphenate:!0,hyphenatedWordSize:6,preHyphen:2,postHyphen:2,consecutiveHyphens:8,zone:36,wordSpacing:[.8,1,1.33],letterSpacing:[0,0,0],glyphSpacing:[1,1,1],autoLeading:1.2,leadingType:0,hanging:!1,burasagari:!1,kinsokuOrder:0,everyLineComposer:!1},a={font:i,fontSize:12,fauxBold:!1,fauxItalic:!1,autoLeading:!0,leading:0,horizontalScale:1,verticalScale:1,tracking:0,autoKerning:!0,kerning:0,baselineShift:0,fontCaps:0,fontBaseline:0,underline:!1,strikethrough:!1,ligatures:!0,dLigatures:!1,baselineDirection:2,tsume:0,styleRunAlignment:2,language:0,noBreak:!1,fillColor:{r:0,g:0,b:0},strokeColor:{r:0,g:0,b:0},fillFlag:!0,strokeFlag:!1,fillFirst:!0,yUnderline:1,outlineWidth:1,characterDirection:0,hindiNumbers:!1,kashida:1,diacriticPos:2},s={isOn:!1,show:!1,size:18,leading:22,color:{r:0,g:0,b:255},leadingFillColor:{r:0,g:0,b:255},alignLineHeightToGridFlags:!1},l=["justification","firstLineIndent","startIndent","endIndent","spaceBefore","spaceAfter","autoHyphenate","hyphenatedWordSize","preHyphen","postHyphen","consecutiveHyphens","zone","wordSpacing","letterSpacing","glyphSpacing","autoLeading","leadingType","hanging","burasagari","kinsokuOrder","everyLineComposer"],u=["font","fontSize","fauxBold","fauxItalic","autoLeading","leading","horizontalScale","verticalScale","tracking","autoKerning","kerning","baselineShift","fontCaps","fontBaseline","underline","strikethrough","ligatures","dLigatures","baselineDirection","tsume","styleRunAlignment","language","noBreak","fillColor","strokeColor","fillFlag","strokeFlag","fillFirst","yUnderline","outlineWidth","characterDirection","hindiNumbers","kashida","diacriticPos"],d=["none","crisp","strong","smooth","sharp"],c=["left","right","center"];function f(e){return e.substr(0,1).toUpperCase()+e.substr(1)}function h(e){return e&&"r"in e?["a"in e?e.a:1,e.r/255,e.g/255,e.b/255]:[0,0,0,0]}function p(e,t){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function v(e,t){if(!e||!t)return!1;for(var r=0,n=Object.keys(e);r<n.length;r++){if(e[a=n[r]]!==t[a])return!1}for(var i=0,o=Object.keys(t);i<o.length;i++){var a;if(e[a=o[i]]!==t[a])return!1}return!0}function g(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t.name)return r;return e.push(t),e.length-1}function w(e,t,r){for(var n,i,o={},a=0,s=t;a<s.length;a++){var l=s[a],u=f(l);void 0!==e[u]&&(o[l]="justification"===l?c[e[u]]:"font"===l?r[e[u]]:"fillColor"===l||"strokeColor"===l?(n=e[u],void 0,i=n.Values,0===n.Type?{r:255*i[1],g:255*i[1],b:255*i[1]}:{r:255*i[1],g:255*i[2],b:255*i[3],a:i[0]}):e[u])}return o}function y(e,t,r){for(var n,i={},o=0,a=t;o<a.length;o++){var s=a[o],l=f(s);void 0!==e[s]&&(i[l]="justification"===s?c.indexOf(null!==(n=e[s])&&void 0!==n?n:"left"):"font"===s?g(r,e[s]):"fillColor"===s||"strokeColor"===s?{Type:1,Values:h(e[s])}:e[s])}return i}function m(e,t){return w(e,l,t)}function b(e,t){return w(e,u,t)}function S(e,t){return y(e,l,t)}function k(e,t){return y(e,u,t)}function U(e,t,r){if(t.length){for(var n=function(r){var n=t[0].style[r];if(void 0!==n){(Array.isArray(n)?t.every(function(e){return p(e.style[r],n)}):"object"==typeof n?t.every(function(e){return v(e.style[r],n)}):t.every(function(e){return e.style[r]===n}))&&(e[r]=n)}if(void 0!==e[r])for(var i=0,o=t;i<o.length;i++){var a=o[i];(Array.isArray(n)?p(a.style[r],n):"object"==typeof n?v(a.style[r],n):a.style[r]===n)&&delete a.style[r]}},i=0,o=r;i<o.length;i++){n(o[i])}t.every(function(e){return 0===Object.keys(e.style).length})&&(t.length=0)}}r.decodeEngineData=function(e){var t,r,n,i,o,a,s=e.EngineDict,c=e.ResourceDict,f=c.FontSet.map(function(e){return{name:e.Name,script:e.Script,type:e.FontType,synthetic:e.Synthetic}}),h={text:s.Editor.Text.replace(/\r/g,"\n").replace(/\n$/,""),antiAlias:null!==(t=d[s.AntiAlias])&&void 0!==t?t:"smooth",useFractionalGlyphWidths:!!s.UseFractionalGlyphWidths,superscriptSize:c.SuperscriptSize,superscriptPosition:c.SuperscriptPosition,subscriptSize:c.SubscriptSize,subscriptPosition:c.SubscriptPosition,smallCapSize:c.SmallCapSize},p=null===(a=null===(o=null===(i=null===(n=null===(r=s.Rendered)||void 0===r?void 0:r.Shapes)||void 0===n?void 0:n.Children)||void 0===i?void 0:i[0])||void 0===o?void 0:o.Cookie)||void 0===a?void 0:a.Photoshop;p&&(h.shapeType=1===p.ShapeType?"box":"point",p.PointBase&&(h.pointBase=p.PointBase),p.BoxBounds&&(h.boxBounds=p.BoxBounds));var v=e.EngineDict.ParagraphRun;h.paragraphStyle={},h.paragraphStyleRuns=[];for(var g=0;g<v.RunArray.length;g++){var w=v.RunArray[g],y=v.RunLengthArray[g],S=m(w.ParagraphSheet.Properties,f);h.paragraphStyleRuns.push({length:y,style:S})}U(h.paragraphStyle,h.paragraphStyleRuns,l),h.paragraphStyleRuns.length||delete h.paragraphStyleRuns;var k=e.EngineDict.StyleRun;for(h.style={},h.styleRuns=[],g=0;g<k.RunArray.length;g++){var I=k.RunLengthArray[g];S=b(k.RunArray[g].StyleSheet.StyleSheetData,f),h.styleRuns.push({length:I,style:S})}return U(h.style,h.styleRuns,u),h.styleRuns.length||delete h.styleRuns,h},r.encodeEngineData=function(e){var t,r,l,u,c,f,p,v,g,w,y,m,b=(e.text||"").replace(/\r?\n/g,"\r")+"\r",U=[{name:"AdobeInvisFont",script:0,type:0,synthetic:0}],I=(null===(t=e.style)||void 0===t?void 0:t.font)||(null===(l=null===(r=e.styleRuns)||void 0===r?void 0:r.find(function(e){return e.style.font}))||void 0===l?void 0:l.style.font)||i,C=[],F=[];if(e.paragraphStyleRuns&&e.paragraphStyleRuns.length)for(var P=0,M=e.paragraphStyleRuns;P<M.length;P++){var B=M[P];F.push(B.length),C.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:S(n(n(n({},o),e.paragraphStyle),B.style),U)},Adjustments:{Axis:[1,0,1],XY:[0,0]}})}else for(var D=0,A=0;D<b.length;D++)13===b.charCodeAt(D)&&(F.push(D-A+1),C.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:S(n(n({},o),e.paragraphStyle),U)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}),A=D+1);for(var E=k(n(n({},a),{font:I}),U),x=[],L=[],T=0,O=e.styleRuns||[{length:b.length,style:e.style||{}}];T<O.length;T++){var R=O[T];L.push(R.length),x.push({StyleSheet:{StyleSheetData:k(n(n({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),R.style),U)}})}var G=n(n({},s),e.gridInfo),j="vertical"===e.orientation?2:0,N="vertical"===e.orientation?1:0,z="box"===e.shapeType?1:0,V={ShapeType:z};0===z?V.PointBase=e.pointBase||[0,0]:V.BoxBounds=e.boxBounds||[0,0,0,0],V.Base={ShapeType:z,TransformPoint0:[1,0],TransformPoint1:[0,1],TransformPoint2:[0,0]};var _={KinsokuSet:[{Name:"PhotoshopKinsokuHard",NoStart:"、。，．・：；？！ー―’”）〕］｝〉》」』】ヽヾゝゞ々ぁぃぅぇぉっゃゅょゎァィゥェォッャュョヮヵヶ゛゜?!)]},.:;℃℉¢％‰",NoEnd:"‘“（〔［｛〈《「『【([{￥＄£＠§〒＃",Keep:"―‥",Hanging:"、。.,"},{Name:"PhotoshopKinsokuSoft",NoStart:"、。，．・：；？！’”）〕］｝〉》」』】ヽヾゝゞ々",NoEnd:"‘“（〔［｛〈《「『【",Keep:"―‥",Hanging:"、。.,"}],MojiKumiSet:[{InternalName:"Photoshop6MojiKumiSet1"},{InternalName:"Photoshop6MojiKumiSet2"},{InternalName:"Photoshop6MojiKumiSet3"},{InternalName:"Photoshop6MojiKumiSet4"}],TheNormalStyleSheet:0,TheNormalParagraphSheet:0,ParagraphSheetSet:[{Name:"Normal RGB",DefaultStyleSheet:0,Properties:S(n(n({},o),e.paragraphStyle),U)}],StyleSheetSet:[{Name:"Normal RGB",StyleSheetData:E}],FontSet:U.map(function(e){return{Name:e.name,Script:e.script||0,FontType:e.type||0,Synthetic:e.synthetic||0}}),SuperscriptSize:null!==(u=e.superscriptSize)&&void 0!==u?u:.583,SuperscriptPosition:null!==(c=e.superscriptPosition)&&void 0!==c?c:.333,SubscriptSize:null!==(f=e.subscriptSize)&&void 0!==f?f:.583,SubscriptPosition:null!==(p=e.subscriptPosition)&&void 0!==p?p:.333,SmallCapSize:null!==(v=e.smallCapSize)&&void 0!==v?v:.7};return{EngineDict:{Editor:{Text:b},ParagraphRun:{DefaultRunData:{ParagraphSheet:{DefaultStyleSheet:0,Properties:{}},Adjustments:{Axis:[1,0,1],XY:[0,0]}},RunArray:C,RunLengthArray:F,IsJoinable:1},StyleRun:{DefaultRunData:{StyleSheet:{StyleSheetData:{}}},RunArray:x,RunLengthArray:L,IsJoinable:2},GridInfo:{GridIsOn:!!G.isOn,ShowGrid:!!G.show,GridSize:null!==(g=G.size)&&void 0!==g?g:18,GridLeading:null!==(w=G.leading)&&void 0!==w?w:22,GridColor:{Type:1,Values:h(G.color)},GridLeadingFillColor:{Type:1,Values:h(G.color)},AlignLineHeightToGridFlags:!!G.alignLineHeightToGridFlags},AntiAlias:d.indexOf(null!==(y=e.antiAlias)&&void 0!==y?y:"sharp"),UseFractionalGlyphWidths:null===(m=e.useFractionalGlyphWidths)||void 0===m||m,Rendered:{Version:1,Shapes:{WritingDirection:j,Children:[{ShapeType:z,Procession:N,Lines:{WritingDirection:j,Children:[]},Cookie:{Photoshop:V}}]}}},ResourceDict:n({},_),DocumentResources:n({},_)}}},{}],12:[function(e,t,r){"use strict";function n(e){return 0==(4294967168&e)?1:0==(4294965248&e)?2:0==(4294901760&e)?3:4}function i(e){for(var t=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){if(r+1<e.length){var o=e.charCodeAt(r+1);56320==(64512&o)&&(r++,t+=n(((1023&i)<<10)+(1023&o)+65536))}}else t+=n(i)}return t}function o(e,t,r){var i=n(r);switch(i){case 1:e[t]=r;break;case 2:e[t]=r>>6&31|192,e[t+1]=63&r|128;break;case 3:e[t]=r>>12&15|224,e[t+1]=r>>6&63|128,e[t+2]=63&r|128;break;default:e[t]=r>>18&7|240,e[t+1]=r>>12&63|128,e[t+2]=r>>6&63|128,e[t+3]=63&r|128}return i}function a(e,t,r){for(var n=0;n<r.length;n++){var i=r.charCodeAt(n);if(i>=55296&&i<=56319){if(n+1<r.length){var a=r.charCodeAt(n+1);if(56320==(64512&a))n++,t+=o(e,t,((1023&i)<<10)+(1023&a)+65536)}}else t+=o(e,t,i)}return t}function s(e,t){if(t>=e.length)throw Error("Invalid byte index");var r=e[t];if(128==(192&r))return 63&r;throw Error("Invalid continuation byte")}Object.defineProperty(r,"__esModule",{value:!0}),r.decodeString=r.encodeString=r.encodeStringTo=r.stringLengthInBytes=void 0,r.stringLengthInBytes=i,r.encodeStringTo=a,r.encodeString=function(e){var t=new Uint8Array(i(e));return a(t,0,e),t},r.decodeString=function(e){for(var t="",r=0;r<e.length;){var n=e[r++],i=void 0;if(0==(128&n))i=n;else if(192==(224&n)){if((i=(31&n)<<6|s(e,r++))<128)throw Error("Invalid continuation byte")}else if(224==(240&n)){if((i=(15&n)<<12|s(e,r++)<<6|s(e,r++))<2048)throw Error("Invalid continuation byte");if(i>=55296&&i<=57343)throw Error("Lone surrogate U+"+i.toString(16).toUpperCase()+" is not a scalar value")}else{if(240!=(248&n))throw Error("Invalid UTF-8 detected");if((i=(15&n)<<18|s(e,r++)<<12|s(e,r++)<<6|s(e,r++))<65536||i>1114111)throw Error("Invalid continuation byte")}i>65535&&(i-=65536,t+=String.fromCharCode(i>>>10&1023|55296),i=56320|1023&i),t+=String.fromCharCode(i)}return t}},{}],13:[function(e,t,r){"use strict";r.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},r.toByteArray=function(e){var t,r,n=u(e),a=n[0],s=n[1],l=new o(function(e,t,r){return 3*(t+r)/4-r}(0,a,s)),d=0,c=s>0?a-4:a;for(r=0;r<c;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;2===s&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,l[d++]=255&t);1===s&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t);return l},r.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=0,s=r-i;a<s;a+=16383)o.push(d(e,a,a+16383>s?s:a+16383));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)n[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function d(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],14:[function(e,t,r){(function(t){
/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/
"use strict";var n=e("base64-js"),i=e("ieee754");r.Buffer=t,r.SlowBuffer=function(e){+e!=e&&(e=0);return t.alloc(+e)},r.INSPECT_MAX_BYTES=50;var o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var r=new Uint8Array(e);return r.__proto__=t.prototype,r}function t(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return s(e,t,r)}function s(e,r,n){if("string"==typeof e)return function(e,r){"string"==typeof r&&""!==r||(r="utf8");if(!t.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var n=0|f(e,r),i=a(n),o=i.write(e,r);o!==n&&(i=i.slice(0,o));return i}(e,r);if(ArrayBuffer.isView(e))return d(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(j(e,ArrayBuffer)||e&&j(e.buffer,ArrayBuffer))return function(e,r,n){if(r<0||e.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<r+(n||0))throw new RangeError('"length" is outside of buffer bounds');var i;i=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);return i.__proto__=t.prototype,i}(e,r,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return t.from(i,r,n);var o=function(e){if(t.isBuffer(e)){var r=0|c(e.length),n=a(r);return 0===n.length?n:(e.copy(n,0,0,r),n)}if(void 0!==e.length)return"number"!=typeof e.length||N(e.length)?a(0):d(e);if("Buffer"===e.type&&Array.isArray(e.data))return d(e.data)}(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return t.from(e[Symbol.toPrimitive]("string"),r,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),a(e<0?0:0|c(e))}function d(e){for(var t=e.length<0?0:0|c(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function c(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function f(e,r){if(t.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||j(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;for(var o=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return O(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return R(e).length;default:if(o)return i?-1:O(e).length;r=(""+r).toLowerCase(),o=!0}}function h(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function p(e,r,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),N(n=+n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof r&&(r=t.from(r,i)),t.isBuffer(r))return 0===r.length?-1:v(e,r,n,i,o);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,r,n):Uint8Array.prototype.lastIndexOf.call(e,r,n):v(e,[r],n,i,o);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){var o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var d=-1;for(o=r;o<s;o++)if(u(e,o)===u(t,-1===d?0:o-d)){if(-1===d&&(d=o),o-d+1===l)return d*a}else-1!==d&&(o-=o-d),d=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var c=!0,f=0;f<l;f++)if(u(e,o+f)!==u(t,f)){c=!1;break}if(c)return o}return-1}function g(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(N(s))return a;e[r+a]=s}return a}function w(e,t,r,n){return G(O(t,e.length-r),e,r,n)}function y(e,t,r,n){return G(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function m(e,t,r,n){return y(e,t,r,n)}function b(e,t,r,n){return G(R(t),e,r,n)}function S(e,t,r,n){return G(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function k(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function U(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,l,u=e[i],d=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c<=r)switch(c){case 1:u<128&&(d=u);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&u)<<6|63&o)>127&&(d=l);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&u)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(d=l)}null===d?(d=65533,c=1):d>65535&&(d-=65536,n.push(d>>>10&1023|55296),d=56320|1023&d),n.push(d),i+=c}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=I));return r}(n)}r.kMaxLength=o,t.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),t.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.buffer}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),t.poolSize=8192,t.from=function(e,t,r){return s(e,t,r)},t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array,t.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},t.allocUnsafe=function(e){return u(e)},t.allocUnsafeSlow=function(e){return u(e)},t.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==t.prototype},t.compare=function(e,r){if(j(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),j(r,Uint8Array)&&(r=t.from(r,r.offset,r.byteLength)),!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var n=e.length,i=r.length,o=0,a=Math.min(n,i);o<a;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0},t.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return t.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var i=t.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){var a=e[n];if(j(a,Uint8Array)&&(a=t.from(a)),!t.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},t.byteLength=f,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},t.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},t.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},t.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?U(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return U(this,t,r);case"ascii":return C(this,t,r);case"latin1":case"binary":return F(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},t.prototype.toLocaleString=t.prototype.toString,t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},t.prototype.compare=function(e,r,n,i,o){if(j(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),!t.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(this===e)return 0;for(var a=(o>>>=0)-(i>>>=0),s=(n>>>=0)-(r>>>=0),l=Math.min(a,s),u=this.slice(i,o),d=e.slice(r,n),c=0;c<l;++c)if(u[c]!==d[c]){a=u[c],s=d[c];break}return a<s?-1:s<a?1:0},t.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},t.prototype.indexOf=function(e,t,r){return p(this,e,t,r,!0)},t.prototype.lastIndexOf=function(e,t,r){return p(this,e,t,r,!1)},t.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return g(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":return y(this,e,t,r);case"latin1":case"binary":return m(this,e,t,r);case"base64":return b(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function C(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function F(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function P(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=T(e[o]);return i}function M(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function B(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function D(e,r,n,i,o,a){if(!t.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function A(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function E(e,t,r,n,o){return t=+t,r>>>=0,o||A(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function x(e,t,r,n,o){return t=+t,r>>>=0,o||A(e,0,r,8),i.write(e,t,r,n,52,8),r+8}t.prototype.slice=function(e,r){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<e&&(r=e);var i=this.subarray(e,r);return i.__proto__=t.prototype,i},t.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||B(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},t.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||B(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},t.prototype.readUInt8=function(e,t){return e>>>=0,t||B(e,1,this.length),this[e]},t.prototype.readUInt16LE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]|this[e+1]<<8},t.prototype.readUInt16BE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]<<8|this[e+1]},t.prototype.readUInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},t.prototype.readUInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},t.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||B(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},t.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||B(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},t.prototype.readInt8=function(e,t){return e>>>=0,t||B(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},t.prototype.readInt16LE=function(e,t){e>>>=0,t||B(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt16BE=function(e,t){e>>>=0,t||B(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},t.prototype.readInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},t.prototype.readFloatLE=function(e,t){return e>>>=0,t||B(e,4,this.length),i.read(this,e,!0,23,4)},t.prototype.readFloatBE=function(e,t){return e>>>=0,t||B(e,4,this.length),i.read(this,e,!1,23,4)},t.prototype.readDoubleLE=function(e,t){return e>>>=0,t||B(e,8,this.length),i.read(this,e,!0,52,8)},t.prototype.readDoubleBE=function(e,t){return e>>>=0,t||B(e,8,this.length),i.read(this,e,!1,52,8)},t.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||D(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},t.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||D(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},t.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,1,255,0),this[t]=255&e,t+1},t.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},t.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);D(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},t.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);D(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},t.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},t.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},t.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeFloatLE=function(e,t,r){return E(this,e,t,!0,r)},t.prototype.writeFloatBE=function(e,t,r){return E(this,e,t,!1,r)},t.prototype.writeDoubleLE=function(e,t,r){return x(this,e,t,!0,r)},t.prototype.writeDoubleBE=function(e,t,r){return x(this,e,t,!1,r)},t.prototype.copy=function(e,r,n,i){if(!t.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var o=i-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,n,i);else if(this===e&&n<r&&r<i)for(var a=o-1;a>=0;--a)e[a+r]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,i),r);return o},t.prototype.fill=function(e,r,n,i){if("string"==typeof e){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!t.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){var o=e.charCodeAt(0);("utf8"===i&&o<128||"latin1"===i)&&(e=o)}}else"number"==typeof e&&(e&=255);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;var a;if(r>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=r;a<n;++a)this[a]=e;else{var s=t.isBuffer(e)?e:t.from(e,i),l=s.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<n-r;++a)this[a+r]=s[a%l]}return this};var L=/[^+/0-9A-Za-z-_]/g;function T(e){return e<16?"0"+e.toString(16):e.toString(16)}function O(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function R(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function j(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function N(e){return e!=e}}).call(this,e("buffer").Buffer)},{"base64-js":13,buffer:14,ieee754:15}],15:[function(e,t,r){r.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,u=l>>1,d=-7,c=r?i-1:0,f=r?-1:1,h=e[t+c];for(c+=f,o=h&(1<<-d)-1,h>>=-d,d+=s;d>0;o=256*o+e[t+c],c+=f,d-=8);for(a=o&(1<<-d)-1,o>>=-d,d+=n;d>0;a=256*a+e[t+c],c+=f,d-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),o-=u}return(h?-1:1)*a*Math.pow(2,o-n)},r.write=function(e,t,r,n,i,o){var a,s,l,u=8*o-i-1,d=(1<<u)-1,c=d>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,p=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+c>=1?f/l:f*Math.pow(2,1-c))*l>=2&&(a++,l/=2),a+c>=d?(s=0,a=d):a+c>=1?(s=(t*l-1)*Math.pow(2,i),a+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;e[r+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[r+h]=255&a,h+=p,a/=256,u-=8);e[r+h-p]|=128*v}},{}]},{},[7])(7)});
